<!DOCTYPE=html>
<!-- oneButtonGames V4
A series of simple games that only need one button
Last Modified Jul 25
Use "npm i -g http-server" and "http-server" for codespace port
-->
<meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1.0, user-scalable=no">
<head>
	<style>
	:root{
		--char: "üê∏";
		--bc: rgb(40,40,40);
		--fc: rgb(200,200,200);
		font-size: 8px;
	}
	body{
		background: var(--bc);
		color: var(--fc);
		text-align: center;
		font-size: 3rem;
	}
	.head{
		font-size: 5rem;
	}
	select{
		background: var(--bc);
		color: var(--fc);
		font-size: inherit;
		border-radius: 10px;
	}
	option{
		background: var(--bc);
		color: var(--fc);
	}
	input[type="number" i] {
	   border-radius: 10px;
	   background: bottom;
	   text-align: center;
	   color: rgb(200,200,200);
	   font-size: smaller;
	}
	.game {
		position: relative;
		justify-self: center;
		border: solid;
	   	border-radius: 10px;
		font-size: 5rem;
	}
	canvas {
		border: solid;
	   	border-radius: 10px;
	}
	table {
		margin: auto;
		text-wrap-mode: nowrap;
		font-size: 2rem;
		text-align: center;
		max-width: 85%;
	}
	td {
		width: 1%;
	}
	.btn{
		background: none;
		color: rgb(200,200,200);
		font-size: inherit;
		border-radius: 10px;
	}
	.btn:hover{
		background: rgb(200,200,200);
		color: rgb(40,40,40);
	}
	.hand{
		border-style: groove;
		display: inline-flex;
	}
	.alive{
		width: 25px;
	   height: 25px;
	   background-color: green;
	}
	.dead{
		width: 25px;
	   height: 25px;
	   background-color: red;
	}
	.char{
		background-image: none;
	}
	.char::before{
		content: var(--char);
	}
	</style>
</head>

<body style="user-select: none; " oncontextmenu="return false;">
	<div id=topStuff>
		<div id=header class=head>Select A Game</div><br>
		<div id=main>
			<select id=game class=drop>
				<option>Pong</option>
				<option>Slot Cars</option>
				<option>First to Answer</option>
				<option>Fastest Clicker</option>
				<option>Reaction Test</option>
				<option>Counting Game</option>
				<option>Final Countdown</option>
				<option>Target Value</option>
				<option>Noise Maker</option>
				<option>PT Audiometry</option>
				<option>Morse Code</option>
				<option>Guess Up 7 Up</option>
				<option>Red Light Green Light</option>
				<option>Flappy Bird</option>
				<option>Flappy Bird V2</option>
				<option>Frogger</option>
				<option>Rythm Game</option>
				<option>Platformer</option>
				<option>Hot Potato</option>
				<option>Hot Potato V2</option>
				<option>Robin Hood</option>
				<option>The Giver</option>
				<option>PEMDAS</option>
				<option>Hill Climb Racing</option>
				<option>Kitten Canon</option>
				<option>Langton Snake</option>
				<option>Simon Says</option>
				<option>TP Unroll</option>
				<option>Lock Picking</option>
				<option>DVD Logos</option>
				<option>Skill Stop Jackpot</option>
				<option>Bowling Sorta</option>
				<option>Kahoot</option>
			</select>
			<button class=btn onclick=chooseGame()>Start the Game</button>
			<button class=btn onclick=resetPlayers()>Clear Players</button>
			&nbsp FPS: <input id=asdf type=number value=60 min=1 max=100 onchange="{fps=1000/this.value}">
			&nbsp Diplay: <Select id=type class=drop onchange="displayType=this.value;">
				<option>HTML</option>
				<option>Canvas</option>
				<option>CSS</option>
			</Select>
		</div>
	</div>
	<br>
	<div id=gZone style="overflow: hidden;"></div>
	<div id=sZone></div>
</body>

<script>
/* TODO
Readd controller players
Add player queueing for dynamic arrays
Add control dials/button for needed games
Change everything to the same thing for scaling
*/

//========================================== Starting Stuff ==========================================
	let gamemode = "home", fps = 17, assets = [], temp, startScreen = {}, displayType = "HTML";
	let maxX, maxY, timeLimit, currTime = Date.now(); startTime = Date.now();
	let mousePlayer = false, gameState = 0, canvas, ctx;
	let players = [{score: 0, pressed: 0, status: 0, colour: "white", id: "M", emoji: "üòä"}];
	function resetPlayers() {
		players = [{score: 0, pressed: 0, status: 0, colour: "white", id: "M", emoji: "üòä"}];
		keyPlayers = {}; // Map from key -> player index
	}

	function chooseGame() {
		startScreen.html = main.innerHTML;
		startScreen.game = document.getElementById('game').selectedIndex;
		startScreen.asdf = asdf.value
		startScreen.type = document.getElementById('type').selectedIndex;
		gamemode = game.value.toLowerCase().replace(/[-_\s](.)/g, (_, c) => c.toUpperCase());
		header.innerHTML = game.value;
		main.innerHTML = `<button class=btn onclick=goBack();>Go Back</button>&ensp;`;
		main.innerHTML += `<button class=btn onclick=clearGame()>Reset</button>&ensp;`;
		main.innerHTML += `"Fun" Mode <input type='checkbox' id='rando'>`;
		clearGame();
	}

	function clearGame() {
		temp = [];
		assets = [];
		for (let p of players) {
			for (let key in p) {
				if (!["colour", "id", "emoji","pressed"].includes(key)) delete p[key];
			}
			p.score = 0;
			p.status = 0
		}
		gameState = 0;
		temp = "";
		timeLimit = 0;
		startTime = Date.now();
		gZone._cssInitialized = false;
	}

	function goBack() {
		topStuff.removeAttribute("style");
		main.innerHTML = startScreen.html;
		document.getElementById('game').selectedIndex = startScreen.game;
		asdf.value = startScreen.asdf;
		document.getElementById('type').selectedIndex = startScreen.type;
		main.removeAttribute("style");
		header.innerHTML = "Select A Game";
		header.removeAttribute("style");
		gZone.innerHTML = "";
		gZone.removeAttribute("style");
		gZone.style.overflow = "hidden";
		sZone.innerHTML = "";
		sZone.removeAttribute("style");
		gamemode = "home";
		clearGame();
	}

	let keyPlayers = {}; // Map from key -> player index
	window.addEventListener("keydown", function(event) {
		let key = event.key;
		if (event.key == "p") debugger;
		if (!(key in keyPlayers)) {
			if (gamemode != "home") return;
			keyPlayers[key] = players.length;
			players.push({score: 0, pressed: 0, status: 0, id: key});
		}
		let p = keyPlayers[key];
		if (players[p].pressed === 0) players[p].pressed = 1;
	});

	window.addEventListener("keyup", function(event) {
		let p = keyPlayers[event.key];
		if (p !== undefined) players[p].pressed = 0;
	});
	window.onmousedown = function() {mousePlayer = true;};
	window.onmouseup = function() {mousePlayer = false;};
	window.addEventListener('touchstart', function() {mousePlayer = true;});
	window.addEventListener('touchend', function() {mousePlayer = false;});

	if ('scrollRestoration' in history) history.scrollRestoration = 'manual';

	gameFrame();
	async function gameFrame(){
		maxX = ~~(window.innerWidth * .9);
		maxY = ~~(window.innerHeight * .7);
		currTime = Date.now();
		if (mousePlayer == true && players[0].pressed == 0) players[0].pressed = 1;
		else if (mousePlayer == false) players[0].pressed = 0;
		for (let [i,p] of players.entries()) {
			if (p.id == undefined) continue;
			if (p.pressed === 1) p.pressed = currTime;
		}
		//=======GAMEPAD DETECTION===============
		// const gamepads = navigator.getGamepads();
		// for (let i in gamepads) {
		// 	let gamepad = gamepads[i];
		// 	if (gamepad == null) continue;
		// 	for (let j in gamepad.buttons) {
		// 		player++;
		// 		if (gamepad.buttons[j].pressed && (players[player].pressed == 0)) players[player].pressed = currTime;
		// 		else if (gamepad.buttons[j].pressed == false) players[player].pressed = 0;
		// 		if (gamemode == "home") {
		// 			if (players[player].pressed == currTime) players[player].colour = '#' + Math.floor(Math.random()*16777215).toString(16).padStart(6, '0');
		// 			gZone.innerHTML += `<label style='color:${players[player].colour}'>${player}<progress 
		// 				value=${gamepad.buttons[j].value} style='width:3%; accent-color:${players[player].colour}; '></progress></label>`;
		// 		}
		// 	}
		// }
		window[gamemode]();
		displayPlayersGame();
		await sleep(fps);
		gameFrame();
	}

	function sleep(ms) {return new Promise(resolve => setTimeout(resolve,ms));}

//============================================= WIP Games ============================================
	function slotCars() {

	}

	

	function dodgeEm() {
		if (gameState == 0) {
			setPlayerAngles();
			let radius = Math.min(maxX, maxY) / 2.5;
			for (let p of players) {
				p.x = maxX/2 + radius * Math.cos(p.angle*Math.PI/180);
				p.y = maxY/2 + radius * Math.sin(p.angle*Math.PI/180);
				p.w = 50;
				p.h = 5;
			}
			gameState = 1;
		}
		if (gameState == 1) {
			let radius = Math.min(maxX, maxY) / 2.5;
			for (let p of players) {
				if (p.pressed != 0) {
					p.angle += 1;
					p.x = maxX/2 + radius * Math.cos(p.angle*Math.PI/180);
					p.y = maxY/2 + radius * Math.sin(p.angle*Math.PI/180);
				}
			}
		}
	}

	function hungryHippos() {

	}

	function war() {

	}

	function firstToAnswer() {
		if (players.length < 2) {gamemode = "rollCredits"; return;}
		if (gameState == 0) {
			gZone.innerHTML = "";
			temp = [];
			for (let p of players) {
				if (p.pressed > startTime) {
					temp.push(p.id);
					gameState = 1;
				}
			}
			if (temp.length > 0) gZone.innerHTML = `Player ${temp[(rando.checked) ? 
				Math.floor(Math.random()*temp.length) : 0]} was first!`;
		}
	}

	function fastestClicker() {
		if (gameState == 0) {
			timeLimit = currTime + 15000;
			gameState = 1;
		}
		if (gameState == 1) {
			if (currTime <= timeLimit) {
				gZone.innerHTML = "SPAM YOUR BUTTON!<br>Time remaining:" + Math.round(timeLimit - currTime);
				for (let p of players) {
					if (p.pressed == currTime) {
						if (rando.checked) (Math.random() < .5) ? p.score-- : p.score++;
						else p.score++;
					}
					if (p.score == 0) continue;
				}
				sZone.innerHTML = displayPlayersTable("score");
			}
			else {
				gZone.innerHTML = "Time is UP!<br>"
				gameState = 2;
				temp = ["M"];
				for (let p of players) {
					if (p.id == "M") continue;
					if (p.score > players[players.findIndex(P => P.id === temp[0])].score) temp = [p.id];
					else if (p.score == players[players.findIndex(P => P.id === temp[0])].score) temp.push(p.id);
				}
				gZone.innerHTML += `Player${(temp.length > 1) ? "s" : ""} ${temp.join(", ")} won with 
				${players[players.findIndex(P => P.id === temp[0])].score} clicks<br><br>`;
			}
		}
	}

	function reactionTest() {
		if (gameState == 0) {
			timeLimit = currTime + Math.random()*9000+1000;
			gameState = 1;
			gZone.innerHTML = "";
		}
		if (gameState == 1) {
			for (let p of players) {
				if ((p.pressed != 0) && (p.score == 0)) {
					if (currTime == timeLimit) p.score = "On the Money!"
					else if (currTime < timeLimit) p.score = "Early Bird";
					else p.score = Math.round(currTime - timeLimit) + "ms late"
				}
			}
			if (currTime > timeLimit) {
				if (rando.checked) {
					gZone.innerHTML = `<div style='position: absolute; margin-left: ${Math.random()*window.innerWidth};
						margin-top: ${Math.random()*window.innerHeight-300};z-index: 1'>&#129712</div><br>`;
				}
				else gZone.innerHTML = "<br>&#129712<br><br>";
				if (currTime > timeLimit + 3000) {
					gameState = 2;
					gZone.innerHTML = displayPlayersTable("score");
				}
			}
		}
	}

	function redLightGreenLight() {
		if (gameState == 0) {
			startTime = currTime;
			timeLimit = startTime + Math.round(Math.random()*2500);
			gameState = 1;
			temp = true;
			sZone.style.position = "fixed";
			sZone.style.placeSelf = "anchor-center";
		}
		if (gameState == 1) {
			window.scrollTo(1000000,0);
			gameState = 2;
			gZone.innerHTML = "<br>";
			let game = "";
			if (currTime > timeLimit) {
				temp ? temp = false : temp = true;
				timeLimit = currTime + Math.round(Math.random()*2000)+500;
				startTime = currTime;
			}
			for (let p of players){
				if (p.pressed != 0 && p.status == 0) {
					if (temp) p.score++;
					//coyote time for reaction is 150ms
					else if (p.score > 10 && (rando.checked || currTime > startTime+150)) p.status = "DEAD";
				}
				if (p.status != "DEAD") gameState = 1;
				if (p.status == "DEAD") game += `<div class=dead style='margin-left:
					${p.score/5}%'>${p.id}</div>`;
				else if (p.score < 450) game += `<div class=alive style='background:
					${p.colour}; margin-left:${p.score/5}%'>${p.id}</div>`;
				else {
					game += `<div class=alive style='margin-left:${p.score/5}%; 
						background-color:yellow'>${p.id}</div>`;
					if (!rando.checked) p.status = "FINISHED";
				}
			}
			gZone.innerHTML += game;
			sZone.innerHTML = "Don't get caught moving."
			if (temp) sZone.innerHTML += "<div style='font-size: 25vh;'>&#128994</div>";
			else {
				sZone.innerHTML += "<div style='font-size: 25vh;'>&#128308</div>";
				if (gameState == 2) sZone.innerHTML = "Everyone is finished";
			}
		}
	}

	function finalCountdown() {
		if (gameState == 0) {
			gameState = 1;
			timeLimit = currTime + 10000;
			sZone.innerHTML = "";
		}
		if (gameState == 1) {
			if (currTime < timeLimit - ((rando.checked) ? Math.random()*5000 : 3000)) {
				gZone.innerHTML = timeLimit-currTime;
			}
			else if (currTime - timeLimit > 4000) {
				sZone.style.display = "";
				gZone.style.display = "";
				gZone.innerHTML = "Time is UP!";
				gameState = 2;
			}
			else {
				sZone.style.display = "none";
				gZone.style.display = "none";
			}
			for (let p of players) {
				if (p.pressed != 0 && p.status == 0) {
					p.status = "FINISHED";
					if (currTime < timeLimit) sZone.innerHTML += `<div style='color: ${p.colour};'>
						Player ${p.id} was ${timeLimit-currTime}ms early</div>`;
					else if (currTime == timeLimit) sZone.innerHTML += `<div style='color: ${p.colour};'>
						Player ${p.id} was on the mark</div>`;
					else sZone.innerHTML += `<div style='color: ${p.colour};'>Player ${p.id} was 
						${currTime-timeLimit}ms late</div>`;
				}
			}
		}
	}

	function noiseMaker() {
		for (let p of players) {
			if (p.pressed == currTime) {
				let wave = ["sine","square","sawtooth","triangle"];
				playSound({
					frequency: (Math.random()*10000)+100,
					type: wave[Math.floor(Math.random()*wave.length)],
					duration: 100,
					gain: 0.15
				});
				gZone.innerHTML += `Player ${p.id} beeped<br>`;
			}
		}
	}

	function morseCode() {
		if (gameState == 0) {
			gameState = 1;
			for (let p of players) {p.score = "";}
			timeLimit = currTime + 10000;
		}
		if (gameState == 1) {
			gZone.innerHTML = "Time remaining:" + Math.round(timeLimit - currTime) + "<br>";
			for (let p of players) {
				if (p.pressed != 0) p.status = p.pressed;
				else {
					if (p.status == 0) ;
					else if (p.status < 0) {
						if (currTime + p.status > 250) {
							p.score += " ";
							p.status = 0;
						}
					} else {
						(currTime - p.status > 150) ? p.score += "-" : p.score += ".";
						p.status = currTime * -1;
					}
				}
			}
			gZone.innerHTML += displayPlayersTable("score");
			if (currTime > timeLimit) gameState = 2;
		}
		if (gameState == 2) {
			gameState = 3;
			gZone.innerHTML = "Time is up!<br>";
			let mCode = [[".-", "A"],["-...", "B"],["-.-.", "C"],["-..", "D"],[".", "E"],["..-.", "F"],["--.", "G"],
			  ["....", "H"],["..", "I"],[".---", "J"],["-.-", "K"],[".-..", "L"],["--", "M"],["-.", "N"],["---", "O"],
			  [".--.", "P"],["--.-", "Q"],[".-.", "R"],["...", "S"],["-", "T"],["..-", "U"],[".--", "W"],
			  ["-..-", "X"],["-.--", "Y"],["--..", "Z"]];
			
			for (let p of players) {
				if (p.score == "") continue;
				temp = p.score.split(" ");
				for (let j in temp) {
					for (let k in mCode) {
						if (temp[j] == mCode[k][0]) temp[j] = mCode[k][1];
					}
				}
				p.score = temp.join("");
				const synth = window.speechSynthesis;
				setTimeout(() => {
				  const utterance = new SpeechSynthesisUtterance(p.score.toString());
				  if (rando.checked) {
				  	utterance.rate = Math.random() + 0.5;
				  	utterance.pitch = Math.random()*1.5+0.5;
				  	utterance.voice = synth.getVoices()[Math.round(Math.random()*synth.getVoices().length)];
				  } else {
				  	utterance.rate = 1.0;
				  	utterance.pitch = 1.1;
				  	utterance.voice = synth.getVoices()[13];
				  }
				  synth.speak(utterance);
				  utterance.addEventListener("speechend", () => {synth.cancel();});
				}, 50);
			}
			gZone.innerHTML = displayPlayersTable("score");
		}
	}

	function flappyBird() {
		if (gameState == 0) {
			gameState = 1;
			temp = [];
			document.body.style.overflowY = "hidden";
			gZone.style.height = "65%";
			gZone.style.width = window.innerWidth;
			gZone.style.borderBottom = "solid";
			gZone.style.borderTop = "solid";
			gZone.style.position = "relative";
			topStuff.style.whiteSpace = "nowrap";
			topStuff.style.textAlign = "right";
			sZone.style.position = "fixed";
		}
		if (gameState == 1) {
			let temp2 = Math.ceil(fps/5), game = "";
			gZone.style.width = parseFloat(gZone.offsetWidth)+(temp2);
			topStuff.style.width = parseInt(gZone.offsetWidth-50);
			sZone.innerHTML = Math.round(parseInt(gZone.offsetWidth) - 1.5*window.innerWidth);
			gameState = 2;
			for (let p of players) {
				if (p.status >= 0) {
					if (p.pressed != 0 && (p.pressed > ((rando.checked) ? currTime-300 : 0))) p.status += temp2/3;
					else p.status -=  temp2/3;
					if (p.status <= 0) p.status = (parseInt(sZone.innerHTML) >= 0) ? -.01 : 0;
					if (p.status > 99) p.status = (parseInt(sZone.innerHTML) >= 0) ? -99 : 99;
					p.score += temp2;
					game += `<div class=alive style='bottom:${p.status}%; background-color:${p.colour}; `;
					gameState = 1;
					let obj1 = {"x1":p.score+100,"x2":p.score+125,"y1":p.status,"y2":p.status+25/gZone.offsetHeight*100};
					for (let j in temp) {
						if (temp[j][0] < gZone.offsetWidth-window.innerWidth) continue;
						let obj2 = {"x1":temp[j][0],"x2":temp[j][0]+50,"y1":temp[j][1],"y2":temp[j][1]+50/gZone.offsetHeight*100};
						if (simpleCollide(obj1,obj2)) p.status *= -1;
					}
				} else {
					game += `<div class=dead style='bottom:${-1*p.status}%;`;
				}
				game += ` left:${p.score+100}; position:absolute; z-index:${p.id};'>${p.id}</div>`;
			}
			if (rando.checked) {
				if (Math.random() < .5*(fps/100)) temp.push([Math.round(parseFloat(gZone.offsetWidth)-50),Math.round(Math.random()*91)]);
			} else {
				if (Math.floor(gZone.offsetWidth / 300) > Math.floor((gZone.offsetWidth - temp2) / 300) && gZone.offsetWidth < 15000) {
					temp2 = [];
					for (let i = 0; i < Math.round(gZone.offsetHeight/50); i++) {
						temp2.push([Math.round(parseFloat(gZone.offsetWidth)-50),i*(50/gZone.offsetHeight*100)]);
					}
					if (gZone.offsetWidth < 5000) temp2.splice(Math.floor(Math.random()*(temp2.length-3)),4);
					else if (gZone.offsetWidth < 10000) temp2.splice(Math.floor(Math.random()*(temp2.length-2)),3);
					else temp2.splice(Math.floor(Math.random()*(temp2.length-1)),2);
					for (let i in temp2) {temp.push(temp2[i]);}
				}
				else if (gZone.offsetWidth >= 15000 && gZone.offsetWidth < 20000) {
					for (let i = 0; i < Math.round(gZone.offsetHeight/50); i++) {
						if (i == 5 || i == 6) continue;
						temp.push([Math.round(parseFloat(gZone.offsetWidth)-50),i*(50/gZone.offsetHeight*100)]);
					}
				}
				else if (gZone.offsetWidth >= 20000) {
					if (Math.random() < .5*(fps/100)) temp.push([Math.round(parseFloat(gZone.offsetWidth)-50),Math.round(Math.random()*91)]);
				}
			}
			for (let i in temp) {
				if (temp[i][0] < gZone.offsetWidth-window.innerWidth-50 && gameState == 1) continue;
				game += `<div style='bottom:${temp[i][1]}%; left:${temp[i][0]}; position:absolute;' class='brick'></div>`;
			}
			gZone.innerHTML = game;
			window.scroll(1000000,0);
		}
	}

	function flappyBirdV2() {
		if (gameState == 0) {
			gameState = 1;
			temp = [];
			document.body.style.overflowY = "hidden";
			gZone.style.height = "65%";
			gZone.style.width = window.innerWidth;
			topStuff.style.whiteSpace = "nowrap";
			topStuff.style.textAlign = "right";
			sZone.style.position = "fixed";
			canvas = document.createElement('canvas');
			canvas.height = parseFloat(gZone.offsetHeight);
			gZone.innerHTML = "";
			gZone.appendChild(canvas);
			ctx = canvas.getContext('2d');
		}
		if (gameState == 1) {
			let temp2 = Math.ceil(fps/5), game = "";
			gZone.style.width = parseFloat(gZone.offsetWidth)+(temp2);
			canvas.width = parseFloat(gZone.offsetWidth);
			ctx = canvas.getContext('2d');
			ctx.clearRect(0,0,canvas.width,canvas.height);
			topStuff.style.width = parseInt(gZone.offsetWidth-50);
			sZone.innerHTML = Math.round(parseInt(gZone.offsetWidth) - 1.5*window.innerWidth);
			gameState = 2;
			for (let p of players) {
				if (p.status >= 0) {
					if (p.pressed != 0 && (p.pressed > ((rando.checked) ? currTime-300 : 0))) p.status += temp2/3;
					else p.status -=  temp2/3;
					if (p.status <= 0) p.status = (parseInt(sZone.innerHTML) >= 0) ? -.01 : 0;
					if (p.status > 96) p.status = (parseInt(sZone.innerHTML) >= 0) ? -96 : 96;
					p.score += temp2;
					gameState = 1;
					let obj1 = {"x1":p.score+100,"x2":0,"y1":canvas.height*(1-p.status/100)-25,"y2":0};
					obj1.x2 = obj1.x1 + 25;
					obj1.y2 = obj1.y1 + 25;
					for (let j in temp) {
						if (temp[j][0] < gZone.offsetWidth-window.innerWidth) continue;
						let obj2 = {"x1":temp[j][0]-100,"x2":0,"y1":canvas.height*(1-temp[j][1]/100)-50,"y2":0};
						obj2.x2 = obj2.x1 + 50;
						obj2.y2 = obj2.y1 + 50;
						if (simpleCollide(obj1,obj2)) p.status *= -1;
					}
					ctx.fillStyle = p.colour;
					ctx.fillRect(p.score+100, canvas.height*(1-p.status/100)-25, 25, 25);
				} else {
					ctx.fillStyle = "#FF0000";
					ctx.fillRect(p.score+100, canvas.height*(1+p.status/100)-25, 25, 25);
				}
				ctx.fillStyle = "white";
				ctx.font = "2rem Georgia";
				ctx.fillText(p.id, p.score+100, canvas.height*(1-p.status/100));
			}
			if (rando.checked) {
				if (Math.random() < .5*(fps/100)) temp.push([Math.round(parseFloat(gZone.offsetWidth)-50),Math.round(Math.random()*91)]);
			} else {
				if (Math.floor(gZone.offsetWidth / 300) > Math.floor((gZone.offsetWidth - temp2) / 300) && gZone.offsetWidth < 15000) {
					temp2 = [];
					for (let i = 0; i < Math.round(gZone.offsetHeight/50); i++) {
						temp2.push([Math.round(parseFloat(gZone.offsetWidth)-50),i*(50/gZone.offsetHeight*100)]);
					}
					if (gZone.offsetWidth < 5000) temp2.splice(Math.floor(Math.random()*(temp2.length-3)),4);
					else if (gZone.offsetWidth < 10000) temp2.splice(Math.floor(Math.random()*(temp2.length-2)),3);
					else temp2.splice(Math.floor(Math.random()*(temp2.length-1)),2);
					for (let i in temp2) {temp.push(temp2[i]);}
				}
				else if (gZone.offsetWidth >= 15000 && gZone.offsetWidth < 20000) {
					for (let i = 0; i < Math.round(gZone.offsetHeight/50); i++) {
						if (i == 5 || i == 6) continue;
						temp.push([Math.round(parseFloat(gZone.offsetWidth)-50),i*(50/gZone.offsetHeight*100)]);
					}
				}
				else if (gZone.offsetWidth >= 20000) {
					if (Math.random() < .5*(fps/100)) temp.push([Math.round(parseFloat(gZone.offsetWidth)-50),Math.round(Math.random()*91)]);
				}
			}
			for (let i in temp) {
				if (temp[i][0] < gZone.offsetWidth-window.innerWidth-50 && gameState == 1) continue;
				ctx.fillStyle = 'fuchsia';
				ctx.fillRect(temp[i][0]-100, canvas.height*(1-temp[i][1]/100)-50, 50, 50);
			}
			window.scroll(1000000,0);
		}
	}

	function countingGame() {
		if (gameState == 0) {
			gameState = 1;
			temp = [];
			gZone.style.width = window.innerWidth;
			gZone.style.height = "65%";
			document.body.style.overflow = "hidden";
			for (let i = 0; i < Math.round(Math.random()*20)+5; i++) {
				let x = Math.round(Math.random()*gZone.offsetWidth);
				let y = Math.round(Math.random()*gZone.offsetHeight);
				let t = Math.round(Math.random()*5000);
				temp.push([x,y,t]);
			}
			startTime = currTime;
		}
		if (gameState == 1) {
			gameState = 2, game = "";
			for (let i in temp) {
				if (temp[i][0] < 0 || temp[i][0] > gZone.offsetWidth || temp[i][1] < 0 
					|| temp[i][1] > gZone.offsetHeight) continue;
				if (currTime > startTime + temp[i][2]) {
					if (rando.checked) {
						temp[i][0] += Math.round(Math.random()*50)*(Math.random() < 0.5 ? -1 : 1)
						temp[i][1] += Math.round(Math.random()*50)*(Math.random() < 0.5 ? -1 : 1);
					}
					else {
						(temp[i][0] < .5*gZone.offsetWidth) ? temp[i][0]-- :  temp[i][0]++;
						(temp[i][1] < .5*gZone.offsetHeight) ? temp[i][1]-- : temp[i][1]++;
					}
				}
				gameState = 1; 
				game += `<div style='bottom:${temp[i][1]}; left:${temp[i][0]}; 
					position:absolute;'>&#128029</div>`;
			}
			gZone.innerHTML = game;
		}
		if (gameState == 2) {
			if (timeLimit == 0) timeLimit = currTime + 10000;
			if (currTime < timeLimit) {
				gZone.innerHTML = `Place your guess now!<br>Time: ${Math.round((timeLimit-currTime)/1000)}`;
				for (let p of players) {if (p.pressed == currTime) p.score++;}
				gZone.innerHTML += displayPlayersTable("score");
			}
			else {
				gZone.innerHTML = `Time is UP!<br>The target was ${temp.length}<br><br>`;
				for (let p of players) {
					if (p.score == 0) {
						p.status = "No guess";
						continue;
					}
					p.score -= temp.length;
					if (p.score > 0) p.status = `Over ${p.score}`;
					else if (p.score < 0) p.status = `Under ${p.score*-1}`;
					else p.status = `Exactamundo`;
				}
				gZone.innerHTML += displayPlayersTable("status");
				gameState = 3;
			}
		}
	}

	function ptAudiometry() {
		if (gameState == 0) {
			if (isNaN(temp)) temp = 0;
			if (timeLimit == 0) timeLimit = 3000 + currTime + Math.random()*3000;
			gZone.innerHTML = "Click the button when the sound plays.<br>";
			if (temp > 9 && (currTime-startTime > 3000)) gameState = 1;
			if (currTime >= timeLimit)  {
				console.log("ding");
				startTime = currTime;
				timeLimit = 3000 + currTime + Math.random()*3000;
				const audioCtx = new AudioContext();
				const oscNode = new OscillatorNode(audioCtx, {type: "sine",
					frequency: (Math.random()*10000)+100});
				let temp2 = 0;
				(rando.checked) ? temp2 = 0.01 : temp2 = Math.random();
				const gainNode = new GainNode(audioCtx, {gain: temp2,});
				oscNode.connect(gainNode).connect(audioCtx.destination);
				oscNode.start();
				setTimeout(() => oscNode.stop(), 300);
				temp++;
			}
			for (let p of players) {
				if (p.pressed == currTime) p.score += (currTime >= (startTime+500)) ? -1 : 1;
			}
		}
		if (gameState == 1) {
			gameState = 2;
			gZone.innerHTML = "Final scores (out of 10)<br>";
			gZone.innerHTML += displayPlayersTable("score");
			sZone.innerHTML = "<br>";
			for (let p of players) {
				if (p.score < 0) sZone.innerHTML += `Player ${p.id} should see a doctor<br>`;
			}
		}
	}

	function targetValue() {
		if (gameState == 0) {
			gameState = 1;
			(rando.checked) ? temp = Math.round(Math.random()*50) : temp = Math.round(Math.random()*500);
			timeLimit = currTime + 10000;
			startTime = currTime;
		}
		if (gameState == 1) {
			let temp2 = Math.ceil(fps/5)
			gZone.innerHTML = `The target is ${temp}<br>Time remaining: ${timeLimit - currTime}<br><br>`;
			for (let p of players) {
				if (p.pressed != 0) (rando.checked && Math.random()>.5) ? p.score -= temp2 : p.score += temp2;
			}
			gZone.innerHTML += displayPlayersTable("score");
			if (currTime >= timeLimit) {
				gameState = 2;
				gZone.innerHTML = `The target is ${temp}<br>Time is UP!<br><br>`;
				for (let p of players) {
					if (p.score == 0) {
						p.status = "Loser";
						continue;
					}
					p.score -= temp;
					if (p.score > 0) p.status = `Over ${p.score}`;
					else if (p.score < 0) p.status = `Under ${p.score*-1}`;
					else {
						p.status = `Hit the target`;
						sZone.innerHTML += `<br>Player ${p.id} hit the target!`;
					}
				}
				gZone.innerHTML += displayPlayersTable("status");
			}
		}
	}

	function guessUp7Up(){
		if (gameState == 0) {
			timeLimit = currTime + 5000;
			gameState = 1;
			temp = [];
			for (let p of players) {
				temp.push((Math.random() < .5) ? "Up" : "Down");
				if (p.status == "Dead") continue;
				p.status = "Down";
			}
			if (!rando.checked) temp = (Math.random() < .5) ? "Up" : "Down";
		}
		if (gameState == 1) {
			gZone.innerHTML = `Were you picked?<br>
				Time remaining: ${Math.ceil((timeLimit-currTime)/1000)}<br>`;
			for (let p of players) {
				if (p.pressed == currTime && p.status != "Dead") {
					p.status = (p.status == "Down") ? "Up" : "Down";
				}
			}
			if (!rando.checked) gZone.innerHTML += displayPlayersTable('status');
			if (currTime >= timeLimit) {
				gameState = 2;
				timeLimit = currTime + 5000;
				for (let p of players) {
					if (p.status == (Array.isArray(temp) ? temp[i] : temp)) {
						p.status = "Alive";
						p.score++;
					}
					else p.status = "Dead";
				}
			}
		}
		if (gameState == 2) {
			gZone.innerHTML = `Farewell to the fallen<br>
				Time remaining: ${Math.ceil((timeLimit-currTime)/1000)}<br>`;
			let temp2 = false;
			for (let p of players) {if (p.status == "Alive") temp2 = true;}
			gZone.innerHTML += displayPlayersTable('status');
			if (currTime >= timeLimit && temp2) gameState = 0;
			else if (!temp2) {
				gameState = 3;
				gZone.innerHTML = "Rounds SURVIVED<br>" + displayPlayersTable('score');
			}
		}
	}

	function frogger() {
		if (gameState == 0) {
			gZone.style.height = "65%";
			gZone.style.position = "relative";
			gZone.style.borderTop = "solid";
			gameState = 1;
			temp = [];
			for (let i in players) {players[i].pos = (i/players.length*70)+20;}
		}
		if (gameState == 1) {
			gZone.innerHTML = "";
			sZone.innerHTML = "";
			let game = "";
			for (let i in temp) {
				temp[i][2] += temp[i][3];
				game += `<div class=brick style='bottom:${temp[i][1]}%; left:${temp[i][2]}%; 
					position:absolute; z-index:1;`
				if (temp[i][3] > 0) game += ` transform: scaleX(-1);`
				game +=` --char:"${temp[i][0]}"'>&nbsp</div>`;
				if (temp[i][2] > 110 || temp[i][2] < -10) temp.splice(i,1);
			}
			for (let p of players) {
				if (isNaN(p.realScore)) p.realScore =  0;
				if (p.pressed != 0 && p.status != "Dead") p.score += Math.ceil(fps/5)/10;
				if (p.status != "Dead") game += `<div class=alive style='background-color: ${p.colour}; `;
				else game += `<div class=dead style='`;
				if (p.score >= 97) {
					p.score = 0;
					p.realScore++;
				}
				sZone.innerHTML += `<div style='left:${p.pos}%; position:absolute'>${p.realScore}</div>`;
				game += `bottom:${p.score}%; left:${p.pos}%; position:absolute; z-index:2;'>${p.id}</div>`;
				if (p.status != "Dead") {
					let obj1 = {"x1":p.pos,"x2":p.pos+(25/gZone.offsetWidth*100),
						"y1":p.score,"y2":p.score+(25/gZone.offsetHeight*100)};
					for (let j in temp){
						let obj2 = {"x1":temp[j][2],"x2":temp[j][2]+(50/gZone.offsetWidth*100),
							"y1":temp[j][1],"y2":temp[j][1]+(50/gZone.offsetHeight*100)};
						if (simpleCollide(obj1,obj2)) {p.status = "Dead";}
					}
				}
			}
			let temp3 = ["üöó","üõª","üöï","üöö","üöô","üöé"];
			if (Math.random() < .1*fps && temp.length < 10) {
				temp.push([temp3[Math.floor(Math.random()*temp3.length)],(Math.random()*80)+10,50,fps/10*(Math.random()-.5)]);
				temp[temp.length-1][2] = (temp[temp.length-1][3] < 0) ? 105 : -5;
			}
			if (rando.checked && Math.random() < .001) {
				temp3 = Math.random()-.5;
				temp.push(["üèéÔ∏è",((temp3+.5)*80)+10,(temp3 > 0) ? 100 : 0,(temp3 > 0) ? -1*fps/5 : fps/5]);
				temp.push(["üöì",((temp3+.5)*80)+10,(temp3 > 0) ? 106 : -6,(temp3 > 0) ? -1*fps/5 : fps/5]);
			}
			gZone.innerHTML = game + "<br>";
		}
	}

	function rythmGame() {
		if (gameState ==  0) {
			gameState = 1;
			temp = [" "];
			for (let i = 1; i < Math.round(Math.random()*500); i++) {
				let temp2 = Math.random();
				if (temp2 > .5) temp[i] = " "
				else if (temp2 > .3) temp[i] = "O"
				else {
					temp2 = (Math.random() > .5) ? "=" : "‚âà";
					for (let j = 0; j < Math.round((Math.random()*5)+2); j++) {
						temp[i] += (j==0) ? "C" : temp2;
					}
				}
				temp[i] = temp[i].replaceAll("undefined","");
			}
			sZone.innerHTML = "<br>" + temp.join("");
			temp = temp.join("").split('');
			document.body.style.overflow = "hidden";
			gZone.style.position = "absolute";
			gZone.style.marginLeft = "50%";
			sZone.style.fontSize = "200%";
			sZone.style.whiteSpace = "nowrap";
			sZone.style.wordSpacing = "1ch";
			sZone.style.left = "100%";
			sZone.style.position = "absolute";
			sZone.style.fontFamily = "times new roman, Courier, monospace";
		}
		if (gameState == 1) {
			gZone.innerHTML = `<br><div style='line-height: 0.8; font-size:10vh; left: 10%; position: fixed;'>|<br>|<br>|<br></div>`;
			sZone.style.left = `${parseFloat(sZone.style.left) - .25}%`;
			let temp2 = temp[Math.round(3-(parseFloat(sZone.style.left))/4)];
			console.log(temp2)
			for (let p of players) {
				if (p.pressed != 0) {
					if ((temp2 == "O" || temp2 == "C") && p.pressed == currTime) p.score += 5;
					else if (temp2 == "‚âà" && p.pressed == currTime) p.score++;
					else if (temp2 == "=" && p.pressed > currTime - 500) p.score++;
					else if (p.pressed == currTime) p.score--;
				}
			}
			if (-1*parseFloat(sZone.style.left) > (sZone.clientWidth/window.innerWidth*110)) {
				gameState = 2;
				gZone.innerHTML = "END OF SONG!<br><br>";
				gZone.innerHTML += displayPlayersTable("score");
				gZone.style.position = "";
				gZone.style.marginLeft = "";
			}
		}
	}

	function platformer() {
		if (gameState == 0) {
			gameState = 1;
			document.body.style.overflowY = "hidden";
			gZone.style.height = "65%";
			gZone.style.width = window.innerWidth;
			gZone.style.borderBottom = "solid";
			gZone.style.borderTop = "solid";
			gZone.style.position = "relative";
			topStuff.style.whiteSpace = "nowrap";
			topStuff.style.textAlign = "right";
			sZone.style.position = "fixed";
			for (let p of players) {p.jumped = false;}
			temp = [["spike",Math.round(parseFloat(gZone.offsetWidth)-50),0,25,25]];
		}
		if (gameState == 1) {
			let temp2 = Math.ceil(fps/3), game = "";
			gZone.style.width = parseFloat(gZone.offsetWidth)+(temp2);
			topStuff.style.width = parseInt(gZone.offsetWidth-50);
			sZone.innerHTML = Math.round(parseInt(gZone.offsetWidth) - 1.5*window.innerWidth);
			gameState = 2;
			playerLoop:
			for (let p of players) {
				if (p.status >= 0) {
					game += `<div class=alive style='bottom:${p.status}%; background-color: ${p.colour}; `;
					if (p.pressed >= currTime-150 && (p.jumped >= currTime-150 || !p.jumped)) {
						p.status +=  temp2/4;
						p.jumped = p.pressed;
					}
					else p.status -=  temp2/6;
					if (p.status < 0) {
						p.status = 0.01;
						p.jumped = false;
					}
					p.score += temp2;
					gameState = 1;
					let obj1 = {"x1":p.score+100,"x2":p.score+125,"y1":p.status,
						"y2":p.status+25/gZone.offsetHeight*100}
					for (let j in temp) {
						let obj2 = {"x1":temp[j][1],"x2":parseFloat(temp[j][1])+parseFloat(temp[j][3]),
							"y1":temp[j][2],"y2":temp[j][2]+temp[j][4]/gZone.offsetHeight*100}
						if (simpleCollide(obj1,obj2)) {
							if (temp[j][0] == "floor" && p.pressed < currTime-150) {
								p.status = temp[j][2];
								p.jumped = false;
							}
							else if (temp[j][0] == "spike") p.status *= -1;
						}
					}
				} else {
					game += `<div class=dead style='bottom:${-1*p.status}%; `;
				}
				game += `left:${p.score+100}; position:absolute;'>${p.id}</div>`;
			}
			if (rando.checked) {
				if (Math.random() < .5*(fps/100)) {
					if (Math.random() < .85) temp.push(["spike",Math.round(parseFloat(gZone.offsetWidth)-10),Math.round(Math.random()*91),25,25]);
					if (Math.random() < .15) temp.push(["spike",Math.round(parseFloat(gZone.offsetWidth)-10),0,25,25]);
					if (Math.random() < .65) temp.push(["floor",Math.round(parseFloat(gZone.offsetWidth)-10),Math.round(Math.random()*91),250,3]);
				}
			} else {
				if (Math.floor(gZone.offsetWidth / 250)>  Math.floor((gZone.offsetWidth - temp2) / 250)) {
					temp.push(["floor",Math.round(parseFloat(gZone.offsetWidth)-10),25,Math.random()*500,3]);
					temp.push(["floor",Math.round(parseFloat(gZone.offsetWidth)-10),50,Math.random()*500,3]);
					temp.push(["floor",Math.round(parseFloat(gZone.offsetWidth)-10),75,Math.random()*500,3]);
				}
				let temp3 = [12.5,37.5,62.5];
				if (Math.random() < .25*(fps/100)) temp.push(["floor",Math.round(parseFloat(gZone.offsetWidth)-50),temp3[Math.floor(Math.random()*3)],50,3]);
				temp3 = [0,12.5,25,37.5,50,62.5,75,90.5];
				if (Math.random() < Math.pow(parseInt(sZone.innerHTML),.25)/(2000/fps)) {
					temp.push(["spike",Math.round(parseFloat(gZone.offsetWidth)-50),temp3[Math.floor(Math.random()*8)],25,25]);
				}
			}
			for (let i in temp) {
				if (temp[i][1] < gZone.offsetWidth-window.innerWidth-500 && gameState == 1 && gameState == 1) continue;
				game += `<div style='position:absolute; left:${temp[i][1]}; bottom:${temp[i][2]}%; background-color:`;
				if (temp[i][0] == "spike") game += `gray; z-index-2; `;
				else game += `fuchsia; `;
				game += `width:${temp[i][3]}; height:${temp[i][4]};'>&nbsp</div>`
			}
			gZone.innerHTML = game;
			window.scroll(1000000,0);
		}
	}

	async function kahoot() {
		let colours = ["black","red","blue","darkgoldenrod","green","purple","fuchsia"];
		let shapes = ["E","‚ñ≤","‚ØÅ","‚¨§","‚óº","‚¨ü","‚¨¢"];
		if (gameState == 0) {
			temp = [];
			let [temp2] = await window.showOpenFilePicker();
			temp2 = await temp2.getFile()
			const reader = new FileReader();
			reader.readAsText(temp2);
			reader.onload = function(e) {
				temp2 = reader.result.split("\r\n");
				for (let i in temp2) {temp[i] = temp2[i].split("|");}
			}
			gameState = 1;
		}
		if (gameState == 1) {
			console.log("no questions found")
			if (temp.length < 1) return;
			console.clear();
			gameState = 2;
			timeLimit = currTime + 10000;
		}
		if (gameState == 2) {
			gZone.innerHTML = temp[0][0] + "<br>Time remaining: " + Math.round(timeLimit-currTime);
			let temp2 = "<div style='display: flex;flex-wrap: wrap;'>";
			for (let i = 1; i < temp[0].length-1; i++) {
				temp2 += "<div class=kaque style='background-color:";
				temp2 += `${colours[i]}'>${shapes[i]}&nbsp${temp[0][i]}</div>`
			}
			temp2 += "</div>"
			gZone.innerHTML += temp2;
			for (let p of players) {
				if (p.pressed == currTime) p.status++;
				if (p.status > temp[0].length-2 || p.status == 0) p.status = 1;
			}
			sZone.innerHTML = "<br>" + displayPlayersTable('status');
			temp2 = document.querySelectorAll("td");
			for (let i in players) {temp2[i].innerHTML = `Player ${p.id}: ${shapes[p.status]}`;}
			if (currTime > timeLimit) {
				gameState = 3;
				timeLimit = currTime + 5000;
				sZone.style.height = "60%";
			}
		}
		if (gameState == 3) {
			if (currTime > timeLimit) {
				console.log(temp[0]);
				temp.shift();
				gameState = (temp.length > 0) ? 2 : 4;
				timeLimit = currTime + 10000;
				sZone.style.height = "";
			}
			if (timeLimit != currTime + 5000) return;
			gZone.innerHTML = temp[0][0] + "<br>The answer was: ";
			let randy = Math.floor((Math.random()*temp[0].length))-1;
			gZone.innerHTML += (rando.checked) ? temp[0][randy] : temp[0][temp[0].at(-1)];
			sZone.innerHTML = "";
			let temp2 = [0,0,0,0,0,0];
			for (let p of players) {
				temp2[p.status]++;
				if (rando.checked) {
					if (p.status == randy) p.score++;
				}
				else {
					if (p.status == temp[0].at(-1)) p.score++;
				}
				p.status = 1;
			}
			let temp3 = `<div style='display:flex; height:50%; justify-content: center; align-items: 
				flex-end;'>`;
			let sum = 0;
			temp2.forEach( num => {sum += num;});
			for (let i in temp2) {
				if (temp2[i] == 0) continue;
				temp3 += `<div style='width: 20%; background-color:${colours[i]}; `;
				temp3 += `height:${Math.round(temp2[i]/sum*100)}%'>${Math.round(temp2[i]/sum*100)}%`;
				temp3 += `<br>${temp[0][i]}</div>`;
			}
			temp3 += "</div>";
			sZone.innerHTML = temp3;
		}
		if (gameState == 4) {
			gZone.innerHTML = "That concludes the questionaire.<br>" + displayPlayersTable('score');
			sZone.innerHTML = "";
			gameState = 5;
		}
	}

	function hotPotato() {
		if (gameState == 0) {
			temp = Math.floor(Math.random() * players.length);
			players[temp].status = "&#129364";
			timeLimit = (rando.checked ? Math.random() * 7000 : 4000) + currTime;
			gameState = 1;
		}
		if (gameState == 1) {
			gZone.innerHTML = `Time remaining: ${Math.round((timeLimit-currTime)/1000)}s<br><br>`;
			let pcount = 0;
			for (let p of players) {
				if (p.status == "Dead") continue;
				if (pcount == temp && p.pressed == currTime) {
					if (rando.checked) {
						while (true) {
							temp = Math.floor(Math.random() * players.length);
							if (players[temp].status == "") break;
						}
					}
					else {
						for (let j in players) {
							if (players[(parseInt(pcount) + parseInt(j)) % players.length].status == "") {
								temp = (parseInt(pcount) + parseInt(j)) % players.length;
								break	;
							}
						}
					}
					p.status = "";
					players[temp].status = "&#129364";
				}
				else if (p.pressed == currTime) p.score--;
				else if (pcount == temp && timeLimit-currTime < 1000) p.score += fps/1000;
				pcount++;
			}
			sZone.innerHTML = displayPlayersTable('status');
			if (currTime >= timeLimit) {
				timeLimit = currTime + 3000;
				gameState = 2;
				gZone.innerHTML = `BOOM! Player ${players[temp].id} is out!<br><br>`;
				sZone.inenerHTML = displayPlayersTable('score');
			}
		}
		if (gameState == 2) {
			let temp2 = (players.filter(p => p.status != 'Dead').length > 1) ? true : false;
			if (currTime >= timeLimit && temp2) {
				players[temp].status = "Dead";
				for (let p of players) {if (p.status != "Dead") p.status = "";}
				if (rando.checked) {
					while (true) {
						temp = Math.floor(Math.random() * players.length);
						if (players[temp].status == "") break;
					}
				}
				else {
					for (let j in players) {
						if (players[(temp + parseInt(j)) % players.length].status == "") {
							temp = (temp + parseInt(j)) % players.length;
							break	;
						}
					}
				}
				players[temp].status = "&#129364";
				timeLimit = (rando.checked ? Math.random() * 7000 : 3000) + currTime;;
				gameState = 1;
			}
			if (!temp2) {
				gameState = 3
				gZone.innerHTML = `Player ${players[temp].id} is winenr!<br>`;
			}
		}
	}

	function hotPotatoV2() {
		if (gameState == 0) {
			for (let p of players) {p.score = 25;}
			temp = Math.floor(Math.random() * players.length);
			players[temp].status = "&#129364";
			startTime = currTime;
			gameState = 1;
		}
		if (gameState == 1) {
			gZone.innerHTML = "Pass before you get burnt!<br><br>"
			if (rando.checked) sZone.innerHTML = "";
			else sZone.innerHTML = displayPlayersTable('status');
			let pcount = 0;
			for (let p of players) {
				if (p.status == "Dead") continue;
				if (pcount == temp && p.pressed == currTime) {
					if (rando.checked) {
						while (true) {
							temp = Math.floor(Math.random() * players.length);
							if (players[temp].status == "") break;
						}
					}
					else {
						for (let j in players) {
							if (players[(parseInt(pcount) + parseInt(j)) % players.length].status == "") {
								temp = (parseInt(pcount) + parseInt(j)) % players.length;
								break	;
							}
						}
					}
					p.status = "";
					players[temp].status = "&#129364";
					startTime = currTime;
				}
				else if (pcount == temp && (currTime-startTime) % Math.round(fps) == 0) {
					p.score -= rando.checked ? Math.floor(Math.random()*7) : 3;
				}
				else if (p.pressed == currTime) p.score -= 5;
				if (p.score <= 0) {
					timeLimit = currTime + 3000;
					gameState = 2;
					gZone.innerHTML = `BOOM! Player ${p.id} is out!<br><br>`;
					p.status = "Dead";
					p.score = "Dead";
					sZone.innerHTML = displayPlayersTable('score');
					for (let p of players) {
						if (p.status == "&#129364") p.status = "";
					}
				}
				pcount++;
			}
		}
		if (gameState == 2) {
			let temp2 = (players.filter(p => p.status != 'Dead').length > 1) ? true : false;
			if (currTime >= timeLimit && temp2) {
				for (let p of players) {if (p.status != "Dead") p.status = "";}
				gameState = 1;
				if (rando.checked) {
					while (true) {
						temp = Math.floor(Math.random() * players.length);
						if (players[temp].status == "") break;
					}
				}
				else {
					for (let j in players) {
						if (players[(temp + parseInt(j)) % players.length].status == "") {
							temp = (temp + parseInt(j)) % players.length;
							break	;
						}
					}
				}
				players[temp].status = "&#129364";
			}
			if (!temp2) {
				gameState = 3
				for (let p of players) {
					if (p.status != "Dead") gZone.innerHTML = `Player ${players[temp].id} is the winner!<br><br>`;
				}
			}
		}
	}

	function theGiver() {
		//start with x points, points are given to a random player while holding a button
		if (gameState == 0) {
			for (let p of players) {p.score = 100;}
			gameState = 1;
		}
		if (gameState == 1) {
			gZone.innerHTML = `Try to reach zero.<br><br>`;
			let pcount = 0;
			for (let p of players) {
				if (p.score == 0) {
					temp = p.id;
					gameState = 2;
				}
				if (p.pressed != 0) {
					(rando.checked && Math.random() > .55) ? p.score++ : p.score--;
					if (rando.checked) players[Math.floor(Math.random() * players.length)].score++;
					else players[(parseInt(pcount) + 1) % players.length].score++;
				}
				pcount++;
			}
			gZone.innerHTML += displayPlayersTable("score");
		}
		if (gameState == 2) {
			gameState = 3;
			gZone.innerHTML = `Player ${temp} reached zero.<br><br>`;
			gZone.innerHTML += displayPlayersTable("score");
		}
	}

	function robinHood() {
		//start with x points, the playerwih the least points can steal, but more stolen = high chance to get caught
		if (gameState == 0) {
			for (let p of players) p.score = p.score = Math.round(Math.random()*100)+50;
			gameState = 1;
		}
		if (gameState == 1) {
			gZone.innerHTML = `Try to steal, don't get caught!<br><br>`;
			temp = minMaxScore();
			let pcount = 0;
			for (let p of players) {
				if (p.score > 0) {
					if (p.pressed != 0 && pcount == temp[0]) p.status++;
					else {
						if (p.status > 0) {
							if ((rando.checked && Math.random() > Math.random()) ||
							 	!rando.checked && Math.random() > p.status/(p.status + players[temp[1]].score)) {
								players[temp[1]].score -= p.status;
								let temp2 = [];
								for (let j in players) {
									if (players[j].score != "CAUGHT!" && players[j].score != "BROKE!"&& j != temp[1]) temp2.push(j);
								}
								for (let j in temp2) {
									players[temp2[j]].score += Math.round(p.status/temp2.length);
								}
							}
							else p.score = "CAUGHT!";
						}
						p.status = 0;
					}
				}
				else if (p.score != "CAUGHT!") p.score = "BROKE"
				pcount ++;
			}
			gZone.innerHTML += displayPlayersTable("score");
			sZone.innerHTML = `<br>Heist score: ${players[temp[0]].status}`
			document.querySelectorAll("td").forEach(x => {
				if (x.innerHTML.includes(`Player ${temp[0]}:`)) x.style.background = "green";
				if (x.innerHTML.includes(`Player ${temp[1]}:`)) x.style.background = "darkgoldenrod";
				if (x.innerHTML.includes(`CAUGHT`) || x.innerHTML.includes(`BROKE`)) x.style.background = "red";
			});
			if (players.filter(p => !isNaN(p.score)).length == 1) gameState = 2;
		}
		if (gameState == 2) {
			gameState = 3;
			gZone.innerHTML = `Player ${temp[1]} hoodwinked everyone.<br><br>`;
			gZone.innerHTML += displayPlayersTable("score");
			document.querySelectorAll("td").forEach(x => {
				if (x.innerHTML.includes(`Player ${temp[1]}:`)) x.style.background = "green";
				else x.style.background = "red";
			});
			sZone.innerHTML = "";
		}
	}

	function pemdas() {
		if (gameState == 0) {
			timeLimit = currTime + 10000;
			temp = [7];
			for (let i = 0; i < 7; i++) {temp.push(Math.round((Math.random()-.5)*10))}
			for (let p of players) {
				p.score = `${rando.checked ? Math.round((Math.random()-.5)*10) : 10}`;
				p.status = "";
				p.remain = "PEMDASP";
			}
			gameState = 1;
		}
		if (gameState == 1) {
			gZone.innerHTML = `${temp.join("&emsp;")}<br>
			Time remaining: ${Math.round((timeLimit-currTime)/1000)}<br>`;
			for (let p of players) {
				if (p.status == "") p.status = p.remain.split("")[0];
				if (p.pressed == currTime) {
					temp2 = p.remain.split("");
					temp3 = temp2.indexOf(p.status);
					p.status = temp2[(temp3 + 1) % temp2.length];
				}
			}
			sZone.innerHTML = displayPlayersTable("status");
			if (currTime > timeLimit) {
				timeLimit = currTime + 5000;
				temp[0]--;
				for (let p of players) {
					if (p.status == "P" && !p.score.includes("(")) {
						if (temp[0] == 6) p.score = "";
						else p.score = p.score.replace(temp[temp.length-temp[0]-2],"");
					}
					if (p.status == "P" && p.score.includes("(")) p.score += `)`;
					else p.score += `${p.status}${temp[temp.length-temp[0]-1]}`;
					p.remain = p.remain.replace(p.status,"");
					p.status = "";
					p.score = p.score.replace("P","(");
					p.score = p.score.replace("E","^");
					p.score = p.score.replace("M","*");
					p.score = p.score.replace("D","/");
					p.score = p.score.replace("A","+");
					p.score = p.score.replace("S","-");
				}
				sZone.innerHTML = displayPlayersTable("score");
				gameState = (temp[0] == 0) ? 3 : 2;
			}
		}
		if (gameState == 2) {
			gZone.innerHTML = `Time remaining: ${Math.round((timeLimit-currTime)/1000)}<br>`;
			if (currTime > timeLimit) {
				timeLimit = currTime + 5000;
				gameState = 1;
			}
		}
		if (gameState == 3) {
			gameState = 4;
			for (let p of players) {
				p.score = p.score.replaceAll(/\^/g,"**");
				p.score = p.score.replaceAll(/--/g,"+");
				p.score = p.score.replaceAll(/\+-/g,"-");
				p.score = p.score.replace(/(-\d+n)\*\*/g, '($1)**');
				p.score = eval(p.score);
			}
			sZone.innerHTML = displayPlayersTable("score");
			let temp2 = minMaxScore();
			gZone.innerHTML = `Player ${temp2[1]} scored the highest... NERD!<br><br>`;
		}
	}

	function kittenCanon() {
		if (gameState == 0) {
			gameState = 1;
			timeLimit = currTime + 3000;
			temp = []; //fill with bombs and spikes
			for (let p of players) {
				p.status = [0,0]; //angle and power then Vx and Vy
				p.x1 = 0;
				p.x2 = 0;
				p.y1 = 0.1;
				p.y2 = 0;
			}
			gZone.style.position = "relative";
			gZone.style.height = "";
			gZone.style.width = "100%";
			gZone.style.top = "30%";
			gZone.style.border = "";
			topStuff.style.position = "fixed";
			topStuff.style.justifySelf = "anchor-center";
			sZone.style.position = "relative";
			sZone.style.top = "30%";
		}
		if (gameState == 1) {
			gZone.innerHTML = "Set your angle";
			let game = "<div style='position: relative; width: 90%; height: 25; z-index: -1; background:var(--fc); justify-self: center'>";
			for (let p of players) {
				if (p.pressed != 0) p.status[0] += fps/16;
				if (p.status[0] > 90) p.status[0] = 0;
				game += `<div class=alive style='background:${p.colour}; position: absolute;
					left:${p.status[0]/90*100}%; z-index:1'>${p.id}</div>`;
			}
			game += "</div>";
			sZone.innerHTML = game;
			if (currTime > timeLimit) {
				gameState = 2;
				timeLimit = currTime + 3000;
			}
		}
		if (gameState == 2) {
			gZone.innerHTML = "Spam for power";
			let game = "<div style='position: relative; width: 90%; height: 25; z-index: -1; background:var(--fc); justify-self: center'>";
			for (let p of players) {
				if (p.pressed == currTime) p.status[1] += 64/fps;
				else p.status[1] -= 2/fps;
				if (p.status[1] < 0) p.status[1] = 0;
				game += `<div class=alive style='background:${p.colour}; position: absolute;
					left:${p.status[1]}%; z-index:1'>${p.id}</div>`;
			}
			game += "</div>";
			sZone.innerHTML = game;
			if (currTime > timeLimit) {
				gameState = 3;
				for (let p of players) {
					p.status[0] *= Math.PI/180;
					let temp2 = [0,0];
					temp2[0] = Math.cos(p.status[0])*p.status[1];
					temp2[1] = Math.sin(p.status[0])*p.status[1];
					p.status = [...temp2];
				}
				gZone.style.position = "relative";
				gZone.style.height = "60%";
				gZone.style.border = "solid";
				sZone.style.position = "fixed";
				sZone.style.justifySelf = "center";
			}
		}
		if (gameState == 3) {
			gameState = 4;
			let game = "";
			for (let p of players) {
				if (p.status[0] > 0) {
					gameState = 3;
					p.x1 += p.status[0];
					p.x2 = p.x1 + 25;
					p.y1 += p.status[1];
					p.y2 = p.y1 + 25;
					if (p.y1 < 0) {
						p.y1 = 0;
						p.status[0] *= .9;
						p.status[1] *= -.85;
					}
					p.status[0] *= .999;
					p.status[1] -= 1;
					if (p.status[0] < .1) p.status[0] = 0;
				}
				game += `<div class=alive style='background: ${p.colour}; position: absolute;
					left: ${p.x1}; bottom: ${p.y1}; z-index:1'>${p.id}</div>`;
				for (let j in temp) {
					if (temp[j].x2 < p.x1 || temp[j].x1 > p.x2) continue;
					if (simpleCollide(p,temp[j])) {
						if (temp[j].type < 0.5) {
							p.status[0] = 0;
							p.status[1] = 0;
						}
						else {
							p.status[0] += 10;
							if (p.status[1] < 1) p.status[1] *= -1;
							p.status[1] += 50;
						}
					}
				}
			}
			
			if (Math.random() > .95) {
				if (!rando.checked) temp.push({type: Math.random(), x1: parseInt(gZone.style.width), y1: 0});
				else temp.push({type: Math.random(), x1: parseInt(gZone.style.width), y1: gZone.offsetHeight*Math.random()});
				temp.at(-1).x2 = temp.at(-1).x1 + 50;
				temp.at(-1).y2 = temp.at(-1).y1 + 50;
			}
			for (let i in temp) {
				game += `<div class=brick style='background: ${(temp[i].type < .5) ? "gray" : "fuchsia"}; position: absolute;
					left: ${temp[i].x1}; bottom: ${temp[i].y1}'></div>`;
			}
			gZone.innerHTML = game;
			gZone.style.width = players[0].x1+1000+"px";
			sZone.innerHTML = Math.round((parseFloat(gZone.style.width))/10);
			window.scrollTo(1000000000000,0);
		}
	}

	function langtonSnake() {
		//a combination of langton's ant, and snake to each other, ends with 1 player left... this game sucks
		let temp2 = ["‚ñ≤","‚ñ∫","‚ñº","‚óÑ","X"];
		if (gameState == 0) {
			gameState = 1;
			timeLimit = currTime + 5000;
			startTime = currTime;
			temp = [];
			for (let i = 0; i < 31; i++) {temp.push(new Array(51).fill(""));}
			sZone.innerHTML = r2t2(temp);
			document.querySelectorAll("table")[0].id = "ttt";
			ttt.style.borderCollapse = "collapse";
			temp = document.querySelectorAll("td");
			for (let i = 0; i < temp.length; i++) {
				temp[i].style.border = "1px solid green";
				temp[i].style.width = "1.2rem";
				temp[i].style.height = "1.2rem";
				temp[i].style.fontSize = "1rem";
				temp[i].style.mixBlendMode = "difference";
			}
			temp = [Math.round(Math.random()*30),Math.round(Math.random()*50)];
			ttt.rows[temp[0]].cells[temp[1]].innerHTML = "&#127822";
			for (let p of players) {
				p.score = [Math.round(Math.random()*3),Math.round(Math.random()*30),Math.round(Math.random()*50)];
				p.history = [(rando.checked) ? (Math.random()*15)+3 : 7,[p.score[1],p.score[2]]];
				ttt.rows[p.score[1]].cells[p.score[2]].innerHTML = temp2[p.score[0]];
				ttt.rows[p.score[1]].cells[p.score[2]].style.background = p.colour;
			}
		}
		if (gameState == 1) {
			gZone.innerHTML = `Next move in ${Math.round(timeLimit - currTime)}`;
			if (timeLimit < currTime) {
				if (currTime > startTime + 30000) timeLimit = currTime + ((rando.checked) ? Math.random()*1000 : 500);
				else timeLimit = currTime + ((rando.checked) ? Math.random()*1500 : 1500);
				document.querySelectorAll("td").forEach(td => td.innerHTML = "");
				for (let p of players) {
					if (p.status != "DEAD") {
						if (p.score[0] == 0 || p.score[0] == 2) {
							p.score[0] = (p.pressed != 0) ? 3 : 1;
							p.score[1] += (p.pressed != 0) ? 1 : -1;
						}
						else {
							p.score[0] = (p.pressed != 0) ? 2 : 0;
							p.score[2] += (p.pressed != 0) ? 1 : -1;
						}
						if (p.score[1] < 0) p.score[1] = 30;
						if (p.score[1] > 30) p.score[1] = 0;
						if (p.score[2] < 0) p.score[2] = 50;
						if (p.score[2] > 50) p.score[2] = 0;
						p.history.push([p.score[1],p.score[2]]);
					}
					ttt.rows[p.score[1]].cells[p.score[2]].innerHTML = temp2[p.score[0]];
					if (p.history.length > p.history[0]+1) {
						ttt.rows[p.history[1][0]].cells[p.history[1][1]].style.background = "";
						p.history.splice(1,1);
					}
					if (ttt.rows[p.score[1]].cells[p.score[2]].style.background != "") {
						p.status = "DEAD";
						p.score[0] = 4;
					}
					else ttt.rows[p.score[1]].cells[p.score[2]].style.background = p.colour;
					if (p.score[1] == temp[0] && p.score[2] == temp[1]) {
						p.history[0] += (rando.checked) ? (Math.random()*5)-3 : 1;
						let temp3 = true;
						while (temp3) {
							temp = [Math.round(Math.random()*30),Math.round(Math.random()*50)];
							if (ttt.rows[temp[0]].cells[temp[1]].style.background == "") temp3 = false;
						}
					}
				}
				if (rando.cheked) {
					let temp3 = true;
					while (temp3) {
						temp = [Math.round(Math.random()*30),Math.round(Math.random()*50)];
						if (ttt.rows[temp[0]].cells[temp[1]].style.background == "") temp3 = false;
					}
				}
				ttt.rows[temp[0]].cells[temp[1]].innerHTML = "&#127822";
				let temp3 = (players.filter(p => p.status != 'DEAD').length > 1) ? true : false;
				gameState = (temp3) ? 1 : 2;
				if (gameState == 2) {
					for (let p of players) {
						if (p.status != "DEAD") {temp3 = p.id; break;}
					}
					gZone.innerHTML = `Player ${temp3} JUAN the game!`
				}
			}
		}
	}

	function simonSays() {
		let temp2 = [
			"Simon says press your button",
			"Simon says don't press your button",
			"Press your button",
			"Don't Press your button",
			"Simon says keep pressing your button",
			"Simon says don't keep pressing your button",
			"Keep pressing your button",
			"Don't keep pressing your button"
		];
		if (gameState == 0) {
			timeLimit = currTime + 5000;
			gameState = 1;
			temp = Math.round(Math.random()*3);
			gZone.innerHTML = temp2[temp] + "<br>";
			if (rando.checked) gZone.innerHTML = temp2[temp].split(" ").sort(() => Math.random() - 0.5).join(" ") + "<br>";
		}
		if (gameState == 1) {
			sZone.innerHTML = displayPlayersTable("status");
			for (let p of players) {
				if (p.status == "Dead") continue;
				p.status = (p.pressed != 0) ? "E" : "";
			}
			if (timeLimit < currTime) {
				timeLimit = currTime + 3000;
				for (let p of players) {
					if (p.status == "Dead") continue;
					if ([0,3,4,6].includes(temp) && p.pressed != 0 || [1,2,5,7].includes(temp) && p.pressed == 0) p.score++;
					else p.status = "Dead";
				}
				if ([0,3,4,6].includes(temp)) temp = Math.round(Math.random()*3) + 4;
				else temp = Math.round(Math.random()*3);
				gZone.innerHTML = temp2[temp] + "<br>";
				if (rando.checked) gZone.innerHTML = temp2[temp].split(" ").sort(() => Math.random() - 0.5).join(" ") + "<br>";
				let temp3 = (players.filter(p => p.status != 'Dead').length > 0) ? true : false;
				gameState = (temp3) ? 1 : 2;
				if (gameState == 2) {
					gZone.innerHTML = "GAME OVER! <br> Rounds obeyed:";
					sZone.innerHTML = displayPlayersTable("score");
					sZone.innerHTML += `<br> Player ${minMaxScore()[1]} was da best`;
				}
			}
		}
	}

	function tpUnroll() {
		if (gameState == 0) {
			timeLimit = currTime + 3000;
			gameState = 1;
			game = "";
			sZone.style.position = "relative";
			sZone.style.height = "50%";
			sZone.style.overflow = "hidden";
			let pcount = 0
			for (let p of players) {
				p.pos = (pcount/players.length*70)+20;
				p.remain = 1000;
				p.loose = parseFloat(sZone.offsetHeight)-40;
				game += `<div style='position: absolute; width: 40; height: ${p.remain/1000*30}; 
					background: ${p.colour}; top: 0; left: ${p.pos}%'></div>`;
				game += `<div style='position: absolute; width: 40; height: 40; background: ${p.colour};
					bottom: ${p.loose}; left: ${p.pos}%; opacity: 30%; z-index: -1'></div>`;
				game += `<div style='position: absolute; bottom: 0; left: ${p.pos-.5}%'>‚úã</div>`;
				pcount++;
			}
			sZone.innerHTML = game;
		}
		if (gameState == 1) {
			gZone.innerHTML = `Starting in ${Math.round((timeLimit - currTime)/1000)}`;
			if (timeLimit < currTime) {
				gZone.innerHTML = "GO!";
				gameState = 2;
			}
		}
		if (gameState == 2) {
			game = "";
			for (let p of players) {
				if (p.pressed != 0) {
					p.score -= (p.score < 0) ? 0 : 5;
					p.status = "‚úä";
					if (p.score >= p.loose && p.score > 0) {
						p.loose -= (rando.checked) ? Math.random()*5 : 5;
						p.remain -= (rando.checked) ? Math.random()*3 : 1;
						if (Math.random() < (rando.checked ? 0.075 : 0.025)) { //chance to rip
							p.loose += Math.random()*(parseFloat(sZone.offsetHeight)-40-p.loose);
						}
						if (p.remain < 0) {
							gameState = 3;
							gZone.innerHTML = `Player ${p.id} unrolled the fastest <br>`;
						}
					}
				}
				else {
					p.score += (p.score > parseFloat(sZone.offsetHeight)-41) ? 0 : 10;
					p.status = "‚úã";
				}
				game += `<div style='position: absolute; width: 40; height: ${p.remain/1000*30}; 
					background: ${p.colour}; top: 0; left: ${p.pos}%'></div>`;
				game += `<div style='position: absolute; width: 40; height: 
					${parseFloat(sZone.offsetHeight)-p.loose}; background: ${p.colour};
					bottom: ${p.loose}; left: ${p.pos}%; opacity: 30%; z-index: -1'></div>`;
				game += `<div style='position: absolute; bottom: ${p.score}; left: ${p.pos-.5}%'>${p.status}</div>`;
			}
			sZone.innerHTML = game;
		}
	}

	function lockPicking() {
		if (gameState == 0) {
			gameState = 1;
			sZone.style.display = "ruby";
			gZone.innerHTML = `Line up and raise the tumblers`;
			temp = [];
			let temp2 = Math.round(Math.random()*2)+3;
			for (let i = 0; i < temp2; i++) {
				temp.push([i*(100/temp2)+2*5,1,(Math.random()*4)+2,2]);
			}
			for (let p of players) {
				p.status = [1,0,0,0]
				if (rando.checked) {
					temp2 = Math.round(Math.random()*4)+1;
					temp = [];
					for (let i = 0; i < temp2; i++) {
						temp.push([i*(100/temp2)+2*5,1,(Math.random()*4)+2,(Math.random()*2)+1]);
					}
				}
				p.score = temp.map(P => [...P]);
			}
		}
		if (gameState == 1) {
			let game = "";
			for (let p of players) {
				if (p.pressed) {
					for (let j in p.score) {
						if (p.status[1] >= p.score[j][0] && p.status[1] <= p.score[j][0]+2.75) {
							p.status[2] += .1;
							if (p.status[2] > 6.75) p.status[2] = 6.75;
							if (p.status[2] < p.score[j][1]) p.score[j][1] += 0.1
						}
					}
					
				}
				else if (p.status[2] > 0) {
					p.status[2] = 0;
					if (p.status[2] < 0) p.status[2] = 0;
				}
				else {
					p.status[1] += p.status[0];
					if (p.status[1] > 91) {
						p.status[0] = -1;
						if (p.status[3] == 1) {
							gameState = 2;
							gZone.innerHTML = `Player ${p.id} unlocked the thing`;
						}
					}
					else if (p.status[1] < 1) p.status[0] = 1;
				}
				game+=`<div style='width:18rem; height:10rem; background:${p.colour}; position:relative; margin:.1rem'>
					<div style='height:2rem; width:90%; background:var(--fc); position:absolute; bottom:1rem; justify-self:anchor-center'>
					<div style='bottom:${p.status[2]+.25}rem; left:${p.status[1]}%; height:1.5rem; width:1.5rem; 
					background:fuchsia; position:absolute; z-index:1'></div>`;
				p.status[3] = 1;
				for (let j in p.score) {
					if (p.score[j][1] > 6.5) p.score[j][1] = 1;
					if (!(p.score[j][1] >= p.score[j][2] && 
						p.score[j][1] <= p.score[j][2] + p.score[j][3]-1)) p.status[3] = 0;
					game+=`<div style='height:7.5rem; width:2rem; background:var(--fc); position:absolute; bottom:1rem; left:${p.score[j][0]}%;'>
					<div style='bottom:${p.score[j][2]}rem; height:${p.score[j][3]}rem; width:2rem; background:green; position:absolute'></div>
					<div style='bottom:${p.score[j][1]}rem; height:1rem; width:2rem; background:black; position:absolute'></div></div>`;
				}
				if (p.status[3] == 1) {
					game += `<div style='position:absolute; background:yellow; height:2rem; width:2rem; left:91%;'></div></div></div>`
				}
				else game += `</div></div>`;
			}
			sZone.innerHTML = game;
		}
	}

	function hillClimbRacing() {
		if (gameState == 0) {
			gameState = 1;
			topStuff.style.position = "fixed";
			topStuff.style.justifySelf = "anchor-center";
			gZone.style.height = "30rem";
			gZone.style.width = "100%";
			gZone.style.position = "relative";
			gZone.style.top= "13rem";
			temp = [{"x1":0,"x2":300,"y1":0,"y2": 50,"colour":"green"}];
			let temp2 = 300;
			let temp3 = 50;
			let game = "";
			for (let i = 0; i < 500; i++) {
				temp3 += (rando.checked) ? (Math.random()*5)-2.5 : (Math.random()*2)-1;
				temp3 = Math.min(90,temp3)
				temp.push({"x1":temp2,"x2":Math.max(1,Math.random()*10),"y1":0,"y2":temp3,
					colour: "#"+Math.floor(Math.random()*16777215).toString(16).padStart(6, '0')});
				temp2 += temp.at(-1).x2;
				if (temp.at(-1).y2 < 1) temp.at(-1).y2 = 1;
			}
			sZone.style.height = "31rem";
			sZone.style.width = "100%";
			sZone.style.position = "absolute";
			sZone.style.overflow = "hidden";
			sZone.style.top = "16rem";
			sZone.style.zIndex = -1;
			for (let p of players) {
				p.rotate = 0
				p.score = 200
			}
		}
		if (gameState == 1) {
			gZone.style.width = parseFloat(gZone.style.width) + ((rando.checked) ? Math.random()*.75 : .33) + "%";
			sZone.style.width = gZone.style.width;
			let game = `<div style='position:fixed'>${parseInt(gZone.style.width)-100}</div>`;
			gameState = 2
			for (let p of players) {
				game += `<div class=alive style='z-index:${p.id}; background: ${p.colour}; position:absolute; `
				if (p.status >= 0) {
					gameState = 1;
					for (let j = temp.length-1; j >= 0; j--) {
						if (p.score+25 > temp[j].x1 && p.score+25 < temp[j].x1+temp[j].x2) {
							if (p.status < temp[j].y2) p.rotate += Math.sqrt(25+Math.pow((p.status-temp[j].y2),2));
							else p.score += Math.sqrt(25+Math.pow((p.status-temp[j].y2),2));	
							p.status = temp[j].y2;
							break;
						}
					}
					if (p.pressed != 0) {
						p.rotate += 200*fps/1000;
						p.score += p.rotate/5;
					}
					else p.rotate -= 500*fps/1000;
					p.status = (p.status < 0) ? 0 : p.status;
					p.rotate = (p.rotate < 0) ? 0 : p.rotate;
					if (p.rotate > 90 || p.score < (parseFloat(gZone.style.width)-105)*window.innerWidth/100) {
						p.status *= -1;
					}
					game += `bottom:${p.status}%; left:${p.score}; transform: rotate(${-1*p.rotate}deg); 
						'>${p.id}</div>`;
				}
				else {
					game += `bottom:${-p.status}%; left:${p.score}; transform: rotate(${-1*p.rotate}deg); 
						'>${p.id}</div>`;
				}
			}
			while (sZone.clientWidth + 10 > temp.at(-1).x1) {
				let temp3 = temp.at(-1).y2;
				temp3 += (rando.checked) ? (Math.random()*5)-2.5 : (Math.random()*2)-1;
				temp3 = Math.min(90, Math.max(1, temp3));
				let temp2 = temp.at(-1).x1 + temp.at(-1).x2;
				let x2 = Math.max(1, Math.random()*10);
				temp.push({"x1":temp2, "x2":x2, "y1":0, "y2":temp3, colour:"green"});
			}
			let temp2 = ""
			for (let i = temp.length - 501; i < temp.length; i++) {
				temp2 += `<div style='background:green; position:absolute; left:${temp[i].x1}; width:${temp[i].x2}; bottom:0; height: ${temp[i].y2}%'>&nbsp;</div>`;
			}
			sZone.innerHTML = temp2
			gZone.innerHTML = game;
			window.scroll(1000000,0);
		}
		if (gameState == 2) {
			gameState = 3;
			let temp2 = ""
			for (let i in temp) {
				temp2 +=  `<div style='background:green; position:absolute; left:${temp[i].x1}; width:${temp[i].x2}; bottom:0; height: ${temp[i].y2}%'>&nbsp;</div>`;
			}
			sZone.innerHTML = temp2;
		}
	}

	function dvdLogos() {
		if (gameState == 0) {
			gameState = 1;
			temp = [];
			for (let p of players) {
				p.status = [0,0,0];
				p.score = [0,window.innerHeight*.35];
			}
			gZone.style.width = window.innerWidth*.9;
			gZone.style.height = window.innerHeight*.7;
			gZone.style.position = "relative";
			gZone.style.border = "solid 1px";
			gZone.style.justifySelf = "center";
			gZone.innerHTML = "";
			sZone.innerHTML = "";
		}
		if (gameState == 1) {
			let game = "";
			for (let p of players) {
				switch (p.status[0]) {
					case 0: p.score[0] += 10; break;
					case 1: p.score[0] -= 10; break;
					case 2: p.score[1] += 10; break;
					case 3: p.score[1] -= 10; break;
					case 4: p.status[1] += 10; break;
					case 5: p.status[1] -= 10; break;
					case 6: p.status[2] += 1; break;
					case 7: p.status[2] -= 1; break;
				}
				if (p.status[0] < 8) {
					if (p.pressed == currTime) p.status[0] += 2;
					if (p.score[0] > (window.innerWidth*.9)-50 || p.score[1] > (window.innerHeight*.7)-50 || 
						p.status[2] > 10) p.status[0]++;
					else if (p.score[0] < 0 || p.score[1] < 0 || p.status[2] < 0) p.status[0]--;
				}
				else {
					if (p.status[0] < 10) {
						p.status[0] = 10;
						let temp2 = [0,0];
						p.status[1] *= Math.PI/180;
						temp2[0] = Math.cos(p.status[1])*p.status[2];
						temp2[1] = Math.sin(p.status[1])*p.status[2];
						p.status[1] = temp2[0];
						p.status[2] = temp2[1];
					}
					p.score[0] += p.status[1];
					p.score[1] += p.status[2];
					let temp2 = 0;
					if (p.score[0] > (window.innerWidth*.9)-50 || p.score[0] < 0) {
						p.status[1] *= -1;
						if (rando.checked) p.status[1] *= (Math.random()*2)+.2;
						if (p.status[1] > 25) p.status[1] = 20;
						temp2++;
					}
					if (p.score[1] > (window.innerHeight*.7)-50 || p.score[1] < 0) {
						p.status[2] *= -1;
						if (rando.checked) p.status[2] *= (Math.random()*2)+.2;
						if (p.status[1] > 25) p.status[2] = 20;
						temp2++;
					}
					if (temp2 == 2) {
						gameState = 2;
						temp.push(p.id);
					}
				}
				if ([4,5].includes(p.status[0])) {
					game += `<div style='background:${p.colour}; width:50; height:50; 
						position:absolute; left:${p.score[0]}; bottom:${p.score[1]}'>
						<div style='background:red; width:5; height:25; position:absolute;
					   justify-self: anchor-center; transform-origin:bottom center; 
						transform: rotate(${p.status[1]}deg)'>&nbsp;</div>${p.id}</div>`;
				}
				else if ([6,7].includes(p.status[0])) {
					game += `<div style='background:${p.colour}; width:50; height:50; 
						position:absolute; left:${p.score[0]}; bottom:${p.score[1]}'>
						<div style='background:red; width:50; height:5; position:absolute;
					   bottom:${p.status[2]*10}%'>&nbsp;</div>${p.id}</div>`;
				}
				else {
					game += `<div style='background:${p.colour}; width:50; height:50; 
						position:absolute; left:${p.score[0]}; bottom:${p.score[1]}'>${p.id}</div>`;
				}
			}
			gZone.innerHTML = game;
			if (temp.length > 0) {
				gameState = 2;
				sZone.innerHTML = `Player${(temp.lengh>1)?"s":""} ${temp.join(", ")} hit the corner`;
				sZone.style.position = "fixed";
				sZone.style.placeSelf = "anchor-center";
			}
		}
	}

	function skillStopJackpot() {
		if (gameState == 0) {
			gameState = 1;
			temp = [];
			let game = "";
			let pcount = 0
			for (let p of players) {
				p.status = [0,0,0];
				p.score = [0,0,0];
				game += `<div style='width:9rem; height:10rem; background:${p.colour}; 
					position:relative; margin:.1rem'>
					<div style='bottom:2rem; left:15%; height:6rem; width:1.5rem; 
					background:linear-gradient(fuchsia,black); background-position-y:${p.score[0]}rem; 
					background-repeat:repeat-y; position:absolute; z-index:1' id=0slot${pcount}></div>
					<div style='bottom:2rem; left:43%; height:6rem; width:1.5rem; 
					background:linear-gradient(fuchsia,black); background-position-y:${p.score[1]}rem;
					background-repeat:repeat-y; position:absolute; z-index:1' id=1slot${pcount}></div>
					<div style='bottom:2rem; left:73%; height:6rem; width:1.5rem; 
					background:linear-gradient(fuchsia,black); background-position-y:${p.score[2]}rem;
					background-repeat:repeat-y; position:absolute; z-index:1' id=2slot${pcount}></div>
					<div style='position:absolute; bottom:4.5rem; left:.5rem; height:1rem; width:8rem; background:var(--fc)'>
					</div><div style='colour:var(--fc); font-size:1.5rem' id=count${pcount}>Attempts: 0</div></div>`;
				pcount++;
			}
			gZone.innerHTML = "Line up the stuff";
			sZone.innerHTML = game;
			sZone.style.display = "ruby";
		}
		if (gameState == 1) {
			let pcount = 0;
			for (let p of players) {
				if (p.pressed == currTime) p.status[0]++;
				if (p.status[0] < 1) p.score[0] += (rando.checked) ? Math.random()-.5 : .1;
				if (p.status[0] < 2) p.score[1] += (rando.checked) ? Math.random()*2-1 : .5;
				if (p.status[0] < 3) p.score[2] += (rando.checked) ? Math.random()*4-2 : 1;
				if (p.status[0] >= 3) {
					if (p.status[1] == 0) p.status[1] = currTime + 1000;
					if (p.status[1] < currTime) {
						p.status[0] = 0;
						p.status[1] = 0;
						p.status[2]++;
						document.getElementById(`count${pcount}`).innerHTML = `Attempts: ${p.status[2]}`;
					} 
				}
				let temp2 = 0;
				for (let j in p.score) {
					if (p.score[j] > 6) p.score[j] = 0;
					if (p.score[j] >= 2.5 && p.score[j] <= 3.5 && p.status[0] >= 3) temp2++;
					document.getElementById(`${j}slot${pcount}`).style.backgroundPositionY = p.score[j] + "rem";
				}
				if (temp2 == 3) temp.push(p.id);
				pcount++;
			}
			if (temp.length > 0) {
				gameState = 2;
				gZone.innerHTML = `Player${(temp.lengh>1)?"s":""} ${temp.join(", ")} hit the jackpot`;
			}
		}
	}

	function bowlingSorta() {
		if (gameState == 0) {
			gameState = 1;
			temp = [];
			let game = "";
			for (let i in players) {
				players[i].status = [0,315,0,0];
				players[i].score = [0,0];
				game += `<div style='width:9rem; height:20rem; background:${players[i].colour}; 
					position:relative; margin:.1rem'>
					<div style='background:peru; width:7rem; height:18rem; position:absolute; place-self:anchor-center'>
					<div style='position:absolute; height:2.5rem; width:2.5rem; background:fuchsia' id=ball${i}>
					<div style='position:absolute; background:red; display:none'></div></div>
					<div style='border:black solid 1px; bottom:16rem; left:.5rem; height:2.5rem; width:1rem; 
					background:var(--fc); position:absolute' id=10pin${i}></div>
					<div style='border:black solid 1px; bottom:16rem; left:2.27rem; height:2.5rem; width:1rem; 
					background:var(--fc); position:absolute' id=9pin${i}></div>
					<div style='border:black solid 1px; bottom:16rem; left:3.75rem; height:2.5rem; width:1rem; 
					background:var(--fc); position:absolute' id=8pin${i}></div>
					<div style='border:black solid 1px; bottom:16rem; left:5.5rem; height:2.5rem; width:1rem; 
					background:var(--fc); position:absolute' id=7pin${i}></div>
					<div style='border:black solid 1px; bottom:15rem; left:1.5rem; height:2.5rem; width:1rem; 
					background:var(--fc); position:absolute' id=6pin${i}></div>
					<div style='border:black solid 1px; bottom:15rem; left:3rem; height:2.5rem; width:1rem; 
					background:var(--fc); position:absolute' id=5pin${i}></div>
					<div style='border:black solid 1px; bottom:15rem; left:4.5rem; height:2.5rem; width:1rem; 
					background:var(--fc); position:absolute' id=4pin${i}></div>
					<div style='border:black solid 1px; bottom:14rem; left:2rem; height:2.5rem; width:1rem; 
					background:var(--fc); position:absolute' id=3pin${i}></div>
					<div style='border:black solid 1px; bottom:14rem; left:4rem; height:2.5rem; width:1rem; 
					background:var(--fc); position:absolute' id=2pin${i}></div>
					<div style='border:black solid 1px; bottom:13rem; left:3rem; height:2.5rem; width:1rem; 
					background:var(--fc); position:absolute' id=1pin${i}></div>
					<br><br><br>${players[i].id}</div></div>`;
			}
			gZone.innerHTML = "Bowl like your life depends on it!";
			sZone.innerHTML = game;
			sZone.style.display = "ruby";
		}
		if (gameState == 1) {
			let pcount = 0;
			for (let p of players) {
				if (p.pressed == currTime) p.status[0] += 2;
				switch (p.status[0]) {
					case 0: p.score[0] += .1; break;
					case 1: p.score[0] -= .1; break;
					case 2: p.status[1] += 5; break;
					case 3: p.status[1] -= 5; break;
					case 4: p.status[2] += .1; break;
					case 5: p.status[2] -= .1; break;
				}
				if (rando.checked && p.pressed == currTime) {
					p.status[0] = 8;
					p.score[0] = Math.random()*4.5;
					p.score[1] = 0;
					p.status[1] = (Math.random()*90)+315;
					p.status[2] = Math.random()*2.5;
				}
				if (p.score[0] < 0 || p.status[1] < 315 || p.status[2] < 0 &&
					p.status[0] < 10) p.status[0]--;
				if (p.score[0] > 4.5 || p.status[1] > 405 || p.status[2] > 2.25 &&
					p.status[0] < 10) p.status[0]++;
				let temp2 = "ball" + pcount;
				temp2 = document.getElementById(temp2);
				if ([2,3].includes(p.status[0])) {
					temp2.children[0].style.display = "";
					temp2.children[0].style.bottom = "2.5rem";
					temp2.children[0].style.height = "1rem";
					temp2.children[0].style.width = ".25rem";
					temp2.children[0].style.justifySelf = "anchor-center";
					temp2.children[0].style.transformOrigin = "bottom center";
					temp2.children[0].style.transform = `rotate(${p.status[1]}deg)`;
				}
				else if ([4,5].includes(p.status[0])) {
					temp2.children[0].style.height = ".25rem";
					temp2.children[0].style.width = "2.5rem";
					temp2.children[0].style.justifySelf = "";
					temp2.children[0].style.transformOrigin = "";
					temp2.children[0].style.transform = "";
					temp2.children[0].style.bottom = p.status[2]+"rem";
				}
				else if (p.status[0] > 5) {
					if (p.status[0] < 10) {
						p.status[0] = currTime + 5000;
						temp2.children[0].style.display = "none";
						let temp3 = [0,0];
						p.status[1] *= Math.PI/180;
						temp3[1] = Math.cos(p.status[1])*p.status[2]/5;
						temp3[0] = Math.sin(p.status[1])*p.status[2]/5;
						p.status[1] = temp3[0];
						p.status[2] = temp3[1];
					}
					p.score[0] += p.status[1];
					p.score[1] += p.status[2];
					if (p.score[0] < -1) p.score[0] = -1;
					if (p.score[0] > 7) p.score[0] = 7;
					if (p.score[1] > 18) p.score[1] = 18;
					let temp3 = Math.max(1, 2.5 * (1 - p.score[1] / 18));
					if (rando.checked) temp3 = Math.max(.1, 1 - p.status[3] / 10);
					temp2.style.height = temp3 + "rem";
					temp2.style.width = temp3 + "rem";
					let obj1 = {x1:parseFloat(temp2.style.left),x2:parseFloat(temp2.style.width),
						y1:parseFloat(temp2.style.bottom),y2:parseFloat(temp2.style.height)};
					obj1.x2 += obj1.x1;
					obj1.y2 += obj1.y1;
					for (let j = 1; j < 11; j++) {
						try {
							let temp3 = j + "pin" + pcount;
							temp3 = document.getElementById(temp3);
							let obj2 = {x1:parseFloat(temp3.style.left),x2:parseFloat(temp3.style.width),
							y1:parseFloat(temp3.style.bottom),y2:parseFloat(temp3.style.height)/2};
							obj2.x2 += obj2.x1;
							obj2.y2 += obj2.y1;
							if (simpleCollide(obj1,obj2)) {
								temp3.remove();
								p.status[3]++;
							}
						} catch (error) {}
						
					}
				}
				temp2.style.left = p.score[0] + "rem";
				temp2.style.bottom = p.score[1] + "rem";
				if (p.status[0] < currTime && p.status[0] > 10) {
					p.status = [0,315,0,p.status[3]];
					p.score = [0,0];
					temp2.style.height = "2.5rem";
					temp2.style.width = "2.5rem";
				}
				if (p.status[3] == 10) temp.push(p.id);
				pcount++
			}
			if (temp.length > 0) {
				gameState = 2;
				gZone.innerHTML = `Player${(temp.lengh>1)?"s":""} ${temp.join(", ")} boweld well`;
			}
		}
	}

//========================================== Finished Games ==========================================
	function home() {
		for (let p of players) {
			if (p.h == null) {p.h = 50; p.w = 50; p.x = Math.random()*maxX; p.y = .5*maxY; p.dx = 0; p.dy = 0; p.colour = "white"; p.emoji = "üòä";}
			p.y += (p.pressed != 0) ? fps/2 : -fps/2;
			if (p.y < 0) p.y = 0;
			if (p.y > maxY-p.h) p.y = maxY-p.h;
			if (p.y > maxY-1.1*p.h && p.status == 0) {
				p.colour = '#' + Math.floor(Math.random()*16777215).toString(16).padStart(6, '0');
				p.status = 1;
			} else if (p.y < maxY-1.1*p.h) p.status = 0;
			if (p.dx != 0) {
				if (p.dx > 0) {p.x += 1; p.dx -= 1;}
				else if (p.dx < 0 ) {p.x -= 1; p.dx += 1;}
			}
			if (p.x < 0) p.x = 0;
				else if (p.x > maxX - p.w) p.x = maxX - p.w;
			else if (p.dx == 0 && Math.random() < 0.01) p.dx = (Math.random() < .3) ? Math.round(Math.random()*200)-100 : 0;
		}
	}
	
	function pong() {
		if (gameState == 0) {
			setPlayerAngles();
			let radius = Math.min(maxX, maxY) / 2.5;
			let limit = (360 / players.filter(p => p.status != "DEAD").length)*.5;
			assets = [{
				x: maxX/2 - 25, y: maxY/2 - 25, colour: "white", id: "ball",
				w: 25, h: 25, angle: Math.random()*360, speed: fps*.1*(Math.random()+1)
			}];
			for (let p of players) {
				if (p.status == "DEAD") continue;
				p.x = maxX/2 + radius * Math.cos(p.angle*Math.PI/180);
				p.y = maxY/2 + radius * Math.sin(p.angle*Math.PI/180);
				p.w = 50;
				p.h = 10;
				p.angle0 = p.angle;
				assets.push({
					x: maxX/2 + radius * Math.cos((p.angle0-limit)*Math.PI/180),
					y: maxY/2 + radius * Math.sin((p.angle0-limit)*Math.PI/180),
					colour: "white", w: 1, h: 50, angle: p.angle0-limit, id:"wall"+p.id
				});
			}
			gameState = 1;
		}
		if (gameState == 1) {
			let radius = Math.min(maxX, maxY) / 2.5;
			let aliveCount = players.filter(p => p.status != "DEAD").length;
			let limit = (360 / aliveCount)*.5;
			for (let p of players) {
				if (p.pressed != 0) {
					if (p.status == "DEAD") continue;
					if (p.status == 0) p.angle += fps*.05*(10/aliveCount);
					else p.angle -= fps*.05*(10/aliveCount);
					if (p.angle > p.angle0 + limit) {
						p.angle = p.angle0 + limit;
						p.status = 1;
					}
					else if (p.angle < p.angle0 - limit) {
						p.angle = p.angle0 - limit;
						p.status = 0;
					}
					p.angle = Math.round(p.angle*10)/10;
					p.x = maxX/2 + radius * Math.cos(p.angle*Math.PI/180);
					p.y = maxY/2 + radius * Math.sin(p.angle*Math.PI/180);
					
				}
				if (!p.collisionBuffer || p.collisionBuffer <= 0) {
					if (distanceCollide(assets[0], p)) {
						assets[0].angle = p.angle - 180 + (Math.random() * 30 - 15);
						while (assets[0].angle <= 0) assets[0].angle += 360;
						while (assets[0].angle >= 360) assets[0].angle -= 360;
						if (rando.checked) {
							assets[0].speed = fps*.1*(Math.random()+1);
							assets[0].w = Math.random()*40+10;
							assets[0].h = Math.random()*40+10;
						}
						p.collisionBuffer = 20;
						playSound({frequency:685,type:"square",duration:100});
					}
				} else {
					p.collisionBuffer--;
				}
			}
			assets[0].x += assets[0].speed * Math.cos(assets[0].angle*Math.PI/180);
			assets[0].y += assets[0].speed * Math.sin(assets[0].angle*Math.PI/180);
			let distFromCenter = Math.sqrt(
				(assets[0].x + assets[0].w / 2 - maxX / 2) * (assets[0].x + assets[0].w / 2 - maxX / 2) +
				(assets[0].y + assets[0].h / 2 - maxY / 2) * (assets[0].y + assets[0].h / 2 - maxY / 2)
			);
			if (distFromCenter > radius*1.2) {
				for (let p of players) {
					let pmin = p.angle0 - limit;
					while (pmin < 0) pmin += 360;
					let pmax = p.angle0 + limit;
					while (pmax >= 360) pmax -= 360;
					if (pmin < pmax) {
						if (assets[0].angle >= pmin && assets[0].angle <= pmax) {
							p.score++;
							if (p.score > 0) p.status = "DEAD";
							gameState = 0;
						}
					} else {
						if (assets[0].angle >= pmin || assets[0].angle <= pmax) {
							p.score++;
							if (p.score > 0) p.status = "DEAD";
							gameState = 0;
						}
					}
				}
				if (players.filter(p => p.status != "DEAD").length < 2) {
					let winner = players.find(p => p.status != "DEAD");
					players[players.findIndex(p => p.id == winner.id)].status = "DEAD";
					assets = [{
						text: `Player ${winner.id} won!`,
						x: 0, y: 0, w:maxX, h:maxY, id: "win", colour: "transparent"
					}];
					gameState = 2;
				}
			}
		}
	}

//========================================= Extra Functions ==========================================
	function simpleCollide(obj1, obj2) {
	  return (
	    obj1.x1 <= obj2.x2 &&
	    obj1.x2 >= obj2.x1 &&
	    obj1.y1 <= obj2.y2 &&
	    obj1.y2 >= obj2.y1
	  );
	}

	function distanceCollide(obj1, obj2) {
		let dx = (obj1.x + obj1.w/2) - (obj2.x + obj2.w/2);
		let dy = (obj1.y + obj1.h/2) - (obj2.y + obj2.h/2);
		let threshold = Math.sqrt((obj1.w*obj1.h + obj2.w*obj2.h)/2)*.115;
		if (Math.sqrt(dx*dx + dy*dy) < (obj1.w + obj2.w)/threshold) return true;
	}

	function playSound(options = {}) {
		const {
			type = "sine",
			frequency = 440,
			gain = 0.15,
			duration = 300,
			detune = 0,
			attack = 0,
			release = 0,
			pan = 0
		} = options;
		const ctx = new (window.AudioContext || window.webkitAudioContext)();
		const osc = ctx.createOscillator();
		const gainNode = ctx.createGain();
		let panNode;
		if (ctx.createStereoPanner) {
			panNode = ctx.createStereoPanner();
			panNode.pan.value = pan;
		}
		osc.type = type;
		osc.frequency.value = frequency;
		osc.detune.value = detune;
		const now = ctx.currentTime;
		// Envelope
		gainNode.gain.setValueAtTime(0, now);
		gainNode.gain.linearRampToValueAtTime(gain, now + attack / 1000);
		gainNode.gain.setValueAtTime(gain, now + attack / 1000 + duration / 1000);
		gainNode.gain.linearRampToValueAtTime(0, now + attack / 1000 + duration / 1000 + release / 1000);
		if (panNode) {
			osc.connect(gainNode).connect(panNode).connect(ctx.destination);
		} else {
			osc.connect(gainNode).connect(ctx.destination);
		}
		osc.start(now);
		osc.stop(now + (attack + duration + release) / 1000);
		osc.onended = () => ctx.close();
	}

	function minMaxScore() {
		let result = [0,0];
		for (let i in players) {
			if (!isNaN(players[i].score)) {
				result = [i,i];
				break;
			}
		}
		for (let i in players) {
			if (players[i].score < players[result[0]].score) result[0] = i;
			if (players[i].score >= players[result[1]].score) result[1] = i;
		}
		return result;
	}

	function displayPlayersTable(propertyName) {
		let tableHTML = '<table>';
		if (players && players.length < 0) return "No players data available.";
		let numCols = Math.floor(Math.sqrt(players.length));
		if (numCols > 4) numCols = 4;
		let cellsInRow = 0;
		tableHTML += '<tbody>';
		let pcount = 0;
		for (let p of players) {
			if (cellsInRow === 0) tableHTML += '<tr>';
			let propertyValue = p[propertyName];
			let cellStyle = `color: ${p.colour || '#ffffff'};`;
			if (p.status == "Dead") cellStyle += " background-color:red;";
			tableHTML += `<td style="${cellStyle}">Player ${p.id}: ${propertyValue}</td>`;
			cellsInRow++;
			if (cellsInRow === numCols || pcount === players.length - 1) {
				while (cellsInRow < numCols && pcount === players.length - 1) {
				   tableHTML += `<td></td>`; // Add empty cell
				   cellsInRow++;
				}
				tableHTML += '</tr>';
				cellsInRow = 0; // Reset cell counter for the next row
			}
			pcount++;
		}
		tableHTML += '</tbody></table>';
		return tableHTML;
	}

	function r2t2(e) {
		let result = "<table>";
		for (let i in e) {
			result += "<tr>";
			for (let j in e[i]) {result += `<td>${e[i][j]}</td>`;}
			result += "</tr>";
		}
		result += "</table>";
		return result;
	}

	function setPlayerAngles() {
		let alivePlayers = players.filter(p => p.status != "DEAD");
		for (let i = 0; i < alivePlayers.length; i++) {
			alivePlayers[i].angle = 360 * (i / alivePlayers.length);
			alivePlayers[i].angle0 = alivePlayers[i].angle; // Add this line
		}
	}

	function displayPlayersGame() {
		if (displayType == "HTML") {
			gZone._cssInitialized = false;
			let game = `<div class=game style='width: ${maxX}px; height: ${maxY}px;'>`;
			for (let [i,p] of players.entries()) {
				if (p.status == "DEAD") continue;
				game += `<div style='background: ${p.colour}; position: absolute; width: ${p.w}; height: ${p.h};
						left: ${p.x}; bottom: ${p.y}; z-index: ${i}; transform: rotate(${(p.angle != null) ? (-90-p.angle) : 0}deg);
						'>${p.id}</div>`;
			}
			if (assets.length != 0) {
				for (let [i,a] of assets.entries()) {
					game += `<div style='position: absolute; bottom: ${a.y}px; left: ${a.x}px; color: ${(a.fcolour) ? a.fcolour : ""};
						 width: ${a.w}px; height: ${a.h}px; background: ${a.colour};
						 transform: rotate(${(a.angle != null) ? (-90-a.angle) : 0}deg);'>${(a.text) ? a.text : ''}</div>`;
				}
			}
			game += "</div>";
			gZone.innerHTML = game;
			return;
		}
		else if (displayType == "Canvas") {
			gZone._cssInitialized = false;
			if (!canvas || !gZone.contains(canvas)) {
				gZone.innerHTML = "";
				canvas = document.createElement("canvas");
				gZone.appendChild(canvas);
				document.querySelector("canvas").setAttribute("id", "canvas");
			}
			canvas.width = maxX;
			canvas.height = maxY;
			canvas.style.width = maxX + "px";
			canvas.style.height = maxY + "px";
			ctx = canvas.getContext("2d");
			ctx.clearRect(0, 0, canvas.width, canvas.height);
			for (let p of players) {
				if (p.status == "DEAD") continue;
				ctx.fillStyle = p.colour;
				ctx.save();
				if (p.angle != null) {
					ctx.translate(p.x + p.w / 2, canvas.height * (1 - p.y / maxY) - p.h / 2);
					ctx.rotate((-90-p.angle) * Math.PI / 180);
					ctx.fillRect(-p.w / 2, -p.h / 2, p.w, p.h);
					ctx.fillStyle = "rgb(200,200,200)";
					ctx.font = "5rem Georgia";
					let text = ctx.measureText(p.id);
					ctx.fillText(p.id, -p.w / 2 + (p.w-text.width)/2, text.actualBoundingBoxAscent+p.h);
				} else {
					ctx.fillRect(p.x, canvas.height*(1-p.y/maxY)-p.h, p.w, p.h);
					ctx.fillStyle = "rgb(200,200,200)";
					ctx.font = "5rem Georgia";
					let text = ctx.measureText(p.id);
					ctx.fillText(p.id, p.x+(p.w-text.width)/2, canvas.height*(1-p.y/maxY)-p.h/2+text.actualBoundingBoxAscent/2);
				}
				ctx.restore();
			}
			for (let a of assets) {
				ctx.fillStyle = a.colour;
				ctx.save();
				if (a.angle != null) {
					ctx.translate(a.x + a.w / 2, canvas.height * (1 - a.y / maxY) - a.h / 2);
					ctx.rotate((-90-a.angle) * Math.PI / 180);
					ctx.fillRect(-a.w / 2, -a.h / 2, a.w, a.h);
					if (a.text != null) {
						ctx.fillStyle = "rgb(200,200,200)";
						ctx.font = "5rem Georgia";
						let text = ctx.measureText(a.text);
						ctx.fillText(a.text, a.x+(a.w-text.width)/2, canvas.height*(1-a.y/maxY)-a.h/2+text.actualBoundingBoxAscent/2);
					}
				}
				else {
					ctx.fillRect(a.x, canvas.height * (1 - a.y / maxY) - a.h, a.w, a.h);
					if (a.text != null) {
						ctx.fillStyle = "rgb(200,200,200)";
						ctx.font = "5rem Georgia";
						let text = ctx.measureText(a.text);
						ctx.fillText(a.text, a.x+(a.w-text.width)/2, text.actualBoundingBoxAscent);
					}
				}
				ctx.restore();
			}
			return;
		}
		else if (displayType == "CSS") {
			if (!gZone._cssInitialized) {
				gZone._cssInitialized = true;
				gZone.innerHTML = "<div class=game style='width: ${maxX}px; height: ${maxY}px;'></div>";
			}
			gZone.firstChild.style.width = maxX + "px";
			gZone.firstChild.style.height = maxY + "px";
			for (let [i,p] of players.entries()) {
				let playerDiv = document.getElementById(`p${p.id}`);
				if (!playerDiv) {
					gZone.firstChild.innerHTML += `<div id=p${p.id} style='position: absolute; z-index: ${i};'>${p.id}</div>`;
					playerDiv = document.getElementById(`p${p.id}`);
				}
				if (p.status == "DEAD") playerDiv.style.display = "none";
				else playerDiv.style.display = "";
				playerDiv.style.background = p.colour;
				playerDiv.style.width = p.w + "px";
				playerDiv.style.height = p.h + "px";
				playerDiv.style.left = p.x + "px";
				playerDiv.style.bottom = p.y + "px";
				playerDiv.style.transform = `rotate(${(p.angle != null) ? (-90-p.angle) : 0}deg)`;
			}
			let assetIds = assets.map(a => `a${a.id}`);
			let existingAssetDivs = Array.from(gZone.firstChild.querySelectorAll('[id^="a"]'));
			for (let div of existingAssetDivs) {
				if (!assetIds.includes(div.id)) div.remove();
			}
			for (let a of assets) {
				let assetDiv = document.getElementById(`a${a.id}`);
				if (!assetDiv) {
					gZone.firstChild.innerHTML += `<div id=a${a.id} style='position: absolute;'>${(a.text) ? a.text : ''}</div>`;
					assetDiv = document.getElementById(`a${a.id}`);
				}
				assetDiv.style.background = a.colour;
				assetDiv.style.color = (a.fcolour) ? a.fcolour : "";
				assetDiv.style.bottom = a.y + "px";
				assetDiv.style.left = a.x + "px";
				assetDiv.style.width = a.w + "px";
				assetDiv.style.height = a.h + "px";
				assetDiv.style.transform = `rotate(${(a.angle != null) ? (-90-a.angle) : 0}deg)`;
			}
		}
		else {return "No players data available.";}
	}

	function rollCredits() {
		if (gameState > 0) return;
		gameState = 1;
		header.innerHTML = "";
		sZone.innerHTML = "";
		main.innerHTML = "";
		gZone.innerHTML = `
			<style>
				@keyframes scrollCredits {
					0% { transform: translateY(100%); }
					100% { transform: translateY(-200%); }
				}
				.credits-container {
					height: 60vh;
					overflow: hidden;
					position: relative;
					width: 80%;
					margin: 20px auto;
					border: 1px solid #ccc;
					padding: 20px;
					box-sizing: border-box;
					text-align: center;
				}
				.credits-content {
					animation: scrollCredits 20s linear forwards;
					position: absolute;
					width: 100%;
					top: 0;
				}
			</style>
			<div class="credits-container">
				<div class="credits-content">
					<h1>Credits</h1>
					<br><br><br><br><br><br>
					Game Designed by: Casey S
					<br><br><br><br><br><br>
					Special Thanks to:
					<br><br>
					The player who showed up alone
					<br><br><br><br><br><br>
					Thanks for Playing!
					<br><br><br><br><br><br><br><br><br><br><br><br>
					beans
					<br><br><br><br><br><br><br><br><br><br><br><br>
					<br><br><br><br><br><br><br><br><br><br><br><br>
				</div>
			</div>
		`;
		setTimeout(() => {goBack();},10000);
	}

</script>
